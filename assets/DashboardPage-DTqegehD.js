import{d as L,r as c,y as D,i as $,c as o,a as e,e as I,w as N,u as i,f as M,g as P,t as d,F as m,n as f,o as r}from"./index-CJnPFP6M.js";import{_ as z}from"./AreaCard.vue_vue_type_script_setup_true_lang-BTyLnMwc.js";import{_ as F}from"./index-Pire2-n3.js";import{w as x}from"./work-BfE4AAb2.js";import{u as T}from"./apiClient-D1LzH2VT.js";import{u as V}from"./calendarStore-BDd63_WM.js";import"./Collection-BS091Fv8.js";import"./utils-jsZz6u_V.js";import"./index-C7zGTSkS.js";const A={class:"flex-1 flex flex-col gap-4"},E={class:"flex gap-4"},R={class:"flex items-center justify-between mb-3"},Y={key:0,class:"text-sm text-muted-foreground"},q={key:1,class:"space-y-6"},G={class:"flex items-center justify-between"},H={class:"text-lg font-semibold"},J={class:"text-sm text-muted-foreground"},K={key:0,class:"text-sm text-muted-foreground"},O={key:1,class:"space-y-3"},Q={class:"text-sm font-medium mb-1"},U={class:"space-y-0.5"},X={key:0,class:"text-sm text-muted-foreground"},Z={key:1,class:"space-y-3"},tt={class:"text-sm font-medium mb-1"},et={class:"space-y-0.5"},ft=L({__name:"DashboardPage",setup(st){const W=M(),v=T(),B=V(),_=l=>`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`,u=new Date,p=new Date(u);p.setDate(p.getDate()+1);const w=_(u),C=_(p),j=["일","월","화","수","목","금","토"][u.getDay()],g=c([]),k=c([]),h=c([]),y=c(!1),S=D(()=>{const l=new Set(k.value),t=g.value.filter(a=>l.has(a.workId)),s=new Map;for(const a of t){const n=a.workType||"미분류";s.has(n)||s.set(n,[]),s.get(n).push(a)}return s}),b=D(()=>{const l=new Set(h.value),t=g.value.filter(a=>l.has(a.workId)),s=new Map;for(const a of t){const n=a.workType||"미분류";s.has(n)||s.set(n,[]),s.get(n).push(a)}return s});return $(async()=>{if(v.selectedProjectId){y.value=!0;try{await B.getCalendar(v.selectedProjectId);const[l,t,s]=await Promise.all([x.getWorkList(),x.getWorkListByDate(w),x.getWorkListByDate(C)]);g.value=l,k.value=t,h.value=s}catch(l){console.error("대시보드 데이터 로드 실패:",l)}finally{y.value=!1}}}),(l,t)=>(r(),o("div",A,[t[7]||(t[7]=e("h1",{class:"text-2xl font-bold"},"대시보드",-1)),e("div",E,[I(z,{height:"flex-none","min-height":"auto",class:"w-1/3"},{default:N(()=>[e("div",R,[t[2]||(t[2]=e("h3",{class:"text-lg font-semibold"},"오늘작업",-1)),I(i(F),{variant:"outline",size:"sm",onClick:t[0]||(t[0]=s=>i(W).push("/helper/schedule/2d"))},{default:N(()=>[...t[1]||(t[1]=[P(" 공정표 수정 ",-1)])]),_:1})]),y.value?(r(),o("div",Y," 로딩 중... ")):(r(),o("div",q,[e("div",G,[e("div",null,[e("p",H,d(i(u).getMonth()+1)+"월 "+d(i(u).getDate())+"일 ("+d(i(j))+") ",1),e("p",J,d(i(w)),1)]),t[3]||(t[3]=e("div",{class:"text-right text-sm text-muted-foreground"},[e("p",null,"맑음"),e("p",null,"-5°C / 3°C")],-1))]),e("div",null,[t[4]||(t[4]=e("h4",{class:"text-sm font-semibold mb-2 text-foreground"},"오늘 작업",-1)),S.value.size===0?(r(),o("div",K," 오늘 예정된 작업이 없습니다. ")):(r(),o("div",O,[(r(!0),o(m,null,f(S.value,([s,a])=>(r(),o("div",{key:s},[e("p",Q,"■ "+d(s),1),e("div",U,[(r(!0),o(m,null,f(a,n=>(r(),o("p",{key:n.workId,class:"text-sm text-muted-foreground"}," - "+d(n.workName),1))),128))])]))),128))]))]),e("div",null,[t[5]||(t[5]=e("h4",{class:"text-sm font-semibold mb-2 text-foreground"},"내일 작업",-1)),b.value.size===0?(r(),o("div",X," 내일 예정된 작업이 없습니다. ")):(r(),o("div",Z,[(r(!0),o(m,null,f(b.value,([s,a])=>(r(),o("div",{key:s},[e("p",tt,"■ "+d(s),1),e("div",et,[(r(!0),o(m,null,f(a,n=>(r(),o("p",{key:n.workId,class:"text-sm text-muted-foreground"}," - "+d(n.workName),1))),128))])]))),128))]))])]))]),_:1}),t[6]||(t[6]=e("div",{class:"flex-1"},null,-1))])]))}});export{ft as default};
