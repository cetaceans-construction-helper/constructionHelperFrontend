import{_ as _e}from"./PageContainer.vue_vue_type_script_setup_true_lang-B_awlWCW.js";import{_ as Te}from"./AreaCard.vue_vue_type_script_setup_true_lang-Buko44Ic.js";import{_ as M}from"./index-D3klz3Fc.js";import{_ as se}from"./Input.vue_vue_type_script_setup_true_lang-B6U590mK.js";import{r as ce}from"./reference-H9G3ZDcq.js";import{a as le}from"./attendance-nzXLqojV.js";import{r as A,D as we,d as oe,c,o as l,a as i,e as s,t as N,w as b,u as e,F as z,n as j,p as ee,g as V,j as te,y as ae,i as Ie,U as Se}from"./index-CLd163ez.js";import{a as xe}from"./apiClient-B23t6YBI.js";import{a as de,b as ue,c as me,d as pe,_ as ye}from"./SelectValue.vue_vue_type_script_setup_true_lang-CD6uRNcp.js";import{X as fe}from"./x-B9Xnmd9v.js";import{c as ve}from"./check-BOjRxVQH.js";import"./Collection-DX4XYVmH.js";import"./index-CEphPQ9z.js";import"./utils-m-6WHacx.js";const ge=ve("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const ie=ve("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);const Z=ve("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function qe(){const t=new Date,v=t.getFullYear(),$=String(t.getMonth()+1).padStart(2,"0"),f=String(t.getDate()).padStart(2,"0");return`${v}-${$}-${f}`}function re(t){const v=t;return v.response?.data?.message||v.message||"알 수 없는 오류가 발생했습니다."}let be=0;function De(){const t=A(qe()),v=A(!1),$=A([]),f=A(!1),E=A([]),x=A([]),n=A(new Map);async function y(){try{E.value=await le.getContractorList(t.value)}catch(d){console.error("업체 목록 로드 실패:",d),alert(re(d))}}async function a(){try{f.value=!0,$.value=await le.getAttendanceListByDate(t.value)}catch(d){console.error("출역인원 조회 실패:",d),$.value=[]}finally{f.value=!1}await g()}async function g(){if(x.value=[],n.value.clear(),$.value.length===0)return;const d=new Map;for(const m of $.value)d.has(m.companyId)||d.set(m.companyId,[]),d.get(m.companyId).push(m);const k=[];for(const[m,w]of d){const L=w[0];if(!L)continue;const T=`box-${++be}`;x.value.push({id:T,companyId:m,companyName:L.companyDisplayName,workTypeId:L.workTypeId,workTypeName:L.workTypeName,laborTypes:[],isLoading:!0});const Y=ce.getLaborTypeListByWorkType(L.workTypeId).then(F=>{const H=x.value.find(R=>R.id===T);if(H){H.laborTypes=F;for(const R of F){const O=w.find(o=>o.laborTypeId===R.id);n.value.set(`${T}-${R.id}`,O?O.count:0)}}}).catch(F=>{console.error(`직종 목록 로드 실패 (${L.companyDisplayName}):`,F)}).finally(()=>{const F=x.value.find(H=>H.id===T);F&&(F.isLoading=!1)});k.push(Y)}await Promise.all(k),n.value=new Map(n.value)}we(t,()=>{y(),a()});function _(){const d={id:`box-${++be}`,companyId:null,companyName:"",workTypeId:null,workTypeName:"",laborTypes:[],isLoading:!1};x.value.push(d)}async function p(d,k){const m=x.value.find(T=>T.id===d);if(!m)return;const w=E.value.find(T=>T.companyId===k);if(!w)return;if(x.value.some(T=>T.id!==d&&T.companyId===k)){alert("이미 추가된 업체입니다.");return}if(!w.workTypeId){alert("해당 업체에 등록된 공종이 없습니다.");return}m.laborTypes.length>0&&m.laborTypes.forEach(T=>{n.value.delete(`${d}-${T.id}`)}),m.companyId=w.companyId,m.companyName=w.companyDisplayName,m.workTypeId=w.workTypeId,m.workTypeName=w.workTypeName||"",m.isLoading=!0;try{const T=await ce.getLaborTypeListByWorkType(w.workTypeId);m.laborTypes=T,T.forEach(Y=>{n.value.set(`${d}-${Y.id}`,0)})}catch(T){console.error("직종 목록 로드 실패:",T),alert(re(T)),m.companyId=null,m.companyName="",m.workTypeId=null,m.workTypeName=""}finally{m.isLoading=!1}}function D(d){const k=x.value.find(m=>m.id===d);k&&k.laborTypes.forEach(m=>{n.value.delete(`${d}-${m.id}`)}),x.value=x.value.filter(m=>m.id!==d)}function X(d,k){return`${d}-${k}`}function U(d,k){return n.value.get(X(d,k))||0}function P(d,k,m){n.value.set(X(d,k),Math.max(0,m))}function J(d,k){const m=U(d,k);P(d,k,m+1)}function G(d,k){const m=U(d,k);P(d,k,m-1)}async function K(){const d=x.value.filter(w=>w.companyId&&w.workTypeId);if(d.length===0){alert("제출할 출역인원이 없습니다.");return}const k=new Map;for(const w of d)if(w.companyId)for(const L of w.laborTypes){const T=U(w.id,L.id);T>0&&(k.has(w.companyId)||k.set(w.companyId,[]),k.get(w.companyId).push({laborTypeId:L.id,count:T}))}if(k.size===0){alert("입력된 인원이 없습니다.");return}const m=[];k.forEach((w,L)=>{m.push({companyId:L,attendances:w})});try{v.value=!0,await le.updateAttendance({date:t.value,entries:m}),alert("출역인원이 저장되었습니다."),await a()}catch(w){console.error("출역인원 저장 실패:",w),alert(re(w))}finally{v.value=!1}}async function ne(){await Promise.all([y(),a()])}return{selectedDate:t,isSubmitting:v,todayAttendance:$,isLoadingToday:f,contractors:E,workTypeBoxes:x,laborCounts:n,loadContractors:y,loadTodayAttendance:a,addEmptyBox:_,selectCompany:p,removeWorkTypeBox:D,getCount:U,setCount:P,incrementCount:J,decrementCount:G,submitAttendance:K,init:ne}}const he={async createEquipmentDeployment(t){await xe.post("/equipment/createEquipmentDeployment",t)},async getEquipmentDeploymentListByDate(t){const{data:v}=await xe.get("/equipment/getEquipmentDeploymentListByDate",{params:{date:t}});return v}};function Ne(t){const v=t;return v.response?.data?.message||v.message||"알 수 없는 오류가 발생했습니다."}let ke=0;function Ee(t,v){const $=A(!1),f=A([]),E=A([]),x=A(!1),n=A([]),y=A(new Map),a=A(new Map);function g(o,r){return`${o}-${r}`}function _(o){return Math.round(o*2)/2}function p(o,r){return y.value.get(g(o,r))??0}function D(o,r,u){const C=g(o,r),I=new Map(y.value);I.set(C,_(Math.max(0,u))),y.value=I}function X(o,r){D(o,r,p(o,r)+.5)}function U(o,r){D(o,r,p(o,r)-.5)}function P(o,r){D(o,r,8)}function J(o,r){D(o,r,4)}function G(o,r){return a.value.get(g(o,r))??0}function K(o,r,u){const C=g(o,r),I=new Map(a.value);I.set(C,Math.max(0,Math.round(u))),a.value=I}function ne(o,r){K(o,r,G(o,r)+1)}function d(o,r){K(o,r,G(o,r)-1)}function k(o,r){const u=n.value.find(q=>q.id===o);if(!u||u.selectedSpecs.some(q=>q.id===r))return;const C=f.value.find(q=>q.id===r);if(!C)return;u.selectedSpecs.push(C);const I=g(o,r),W=new Map(y.value),B=new Map(a.value);W.set(I,0),B.set(I,1),y.value=W,a.value=B}function m(o,r){const u=n.value.find(B=>B.id===o);if(!u)return;u.selectedSpecs=u.selectedSpecs.filter(B=>B.id!==r);const C=g(o,r),I=new Map(y.value),W=new Map(a.value);I.delete(C),W.delete(C),y.value=I,a.value=W}async function w(){try{f.value=await ce.getEquipmentSpecList()}catch(o){console.error("장비규격 전체 목록 로드 실패:",o)}}async function L(){try{x.value=!0,E.value=await he.getEquipmentDeploymentListByDate(t.value)}catch(o){console.error("출역장비 조회 실패:",o),E.value=[]}finally{x.value=!1}T()}function T(){if(n.value=[],E.value.length===0){y.value=new Map,a.value=new Map;return}const o=new Map,r=new Map,u=new Map;for(const C of E.value)u.has(C.companyId)||u.set(C.companyId,[]),u.get(C.companyId).push(C);for(const[C,I]of u){const W=I[0];if(!W)continue;const B=`ebox-${++ke}`,q=[];for(const Q of I){const h=f.value.find(S=>S.id===Q.equipmentSpecId);h&&(q.push(h),o.set(g(B,h.id),Q.workTime),r.set(g(B,h.id),Q.count))}n.value.push({id:B,companyId:C,companyName:W.companyDisplayName,selectedSpecs:q,isLoading:!1})}y.value=o,a.value=r}function Y(){n.value.push({id:`ebox-${++ke}`,companyId:null,companyName:"",selectedSpecs:[],isLoading:!1})}function F(o,r){const u=n.value.find(q=>q.id===o);if(!u)return;const C=v.value.find(q=>q.companyId===r);if(!C)return;if(n.value.some(q=>q.id!==o&&q.companyId===r)){alert("이미 추가된 업체입니다.");return}const W=new Map(y.value),B=new Map(a.value);for(const q of u.selectedSpecs)W.delete(g(o,q.id)),B.delete(g(o,q.id));y.value=W,a.value=B,u.companyId=C.companyId,u.companyName=C.companyDisplayName,u.selectedSpecs=[]}function H(o){const r=n.value.find(u=>u.id===o);if(r){const u=new Map(y.value),C=new Map(a.value);for(const I of r.selectedSpecs)u.delete(g(o,I.id)),C.delete(g(o,I.id));y.value=u,a.value=C}n.value=n.value.filter(u=>u.id!==o)}async function R(){const o=n.value.filter(u=>u.companyId);if(o.length===0){alert("제출할 출역장비가 없습니다.");return}const r=[];for(const u of o)if(u.companyId)for(const C of u.selectedSpecs){const I=g(u.id,C.id),W=a.value.get(I)??0,B=y.value.get(I)??0;W>0&&B>0&&r.push({equipmentSpecId:C.id,count:W,workTime:B,companyId:u.companyId})}if(r.length===0){alert("입력된 장비가 없습니다. 대수와 시간을 모두 입력해주세요.");return}try{$.value=!0,await he.createEquipmentDeployment({date:t.value,entries:r}),alert("출역장비가 저장되었습니다."),await L()}catch(u){console.error("출역장비 저장 실패:",u),alert(Ne(u))}finally{$.value=!1}}we(t,()=>{L()});async function O(){await w(),await L()}return{isSubmittingEquipment:$,allEquipmentSpecs:f,todayEquipment:E,isLoadingEquipment:x,equipmentBoxes:n,equipmentWorkTimes:y,equipmentCounts:a,init:O,addEmptyBox:Y,selectCompany:F,removeEquipmentBox:H,addSpecToBox:k,removeSpecFromBox:m,getWorkTime:p,setWorkTime:D,incrementWorkTime:X,decrementWorkTime:U,setFullDay:P,setHalfDay:J,getCount:G,setCount:K,incrementCount:ne,decrementCount:d,submitEquipmentDeployment:R}}const Le={class:"border border-border rounded-lg bg-card"},Be={class:"flex items-center justify-between px-4 py-3 border-b border-border bg-muted/50"},Me={key:0,class:"font-medium text-sm"},We={key:1,class:"flex-1 mr-4"},Ae={key:0,class:"text-muted-foreground ml-2"},ze={class:"p-4 space-y-3"},Fe={key:0,class:"flex items-center justify-center py-4"},je={key:1,class:"text-center text-muted-foreground text-sm py-2"},Ve={class:"text-sm text-muted-foreground"},Ue={class:"flex items-center gap-2"},He={key:0,class:"text-center text-muted-foreground text-sm py-2"},Re=oe({__name:"LaborCountBox",props:{boxId:{},companyId:{},companyName:{},workTypeName:{},laborTypes:{},isLoading:{type:Boolean},contractors:{},getCount:{type:Function}},emits:["remove","selectCompany","increment","decrement","setCount"],setup(t,{emit:v}){const $=t,f=v;function E(n){n&&f("selectCompany",$.boxId,String(n))}function x(n,y){const a=parseInt(String(y),10);f("setCount",$.boxId,n,isNaN(a)?0:a)}return(n,y)=>(l(),c("div",Le,[i("div",Be,[t.companyId?(l(),c("div",Me,N(t.companyName)+" - "+N(t.workTypeName),1)):(l(),c("div",We,[s(e(ye),{"onUpdate:modelValue":E},{default:b(()=>[s(e(de),null,{default:b(()=>[s(e(ue),{placeholder:"협력업체 선택"})]),_:1}),s(e(me),null,{default:b(()=>[(l(!0),c(z,null,j(t.contractors,a=>(l(),ee(e(pe),{key:a.companyId,value:a.companyId},{default:b(()=>[V(N(a.companyDisplayName)+" ",1),a.workTypeName?(l(),c("span",Ae," ("+N(a.workTypeName)+") ",1)):te("",!0)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])),s(e(M),{variant:"ghost",size:"icon-sm",onClick:y[0]||(y[0]=a=>f("remove",t.boxId))},{default:b(()=>[s(e(fe),{class:"w-4 h-4"})]),_:1})]),i("div",ze,[t.isLoading?(l(),c("div",Fe,[s(e(ge),{class:"w-5 h-5 animate-spin text-muted-foreground"}),y[1]||(y[1]=i("span",{class:"ml-2 text-sm text-muted-foreground"},"직종 목록 로딩중...",-1))])):t.companyId?(l(),c(z,{key:2},[(l(!0),c(z,null,j(t.laborTypes,a=>(l(),c("div",{key:a.id,class:"flex items-center justify-between"},[i("span",Ve,N(a.name),1),i("div",Ue,[s(e(M),{variant:"outline",size:"icon-sm",onClick:g=>f("decrement",t.boxId,a.id)},{default:b(()=>[s(e(ie),{class:"w-4 h-4"})]),_:1},8,["onClick"]),s(e(se),{type:"number",class:"w-16 text-center h-8","model-value":t.getCount(t.boxId,a.id),min:"0","onUpdate:modelValue":g=>x(a.id,g)},null,8,["model-value","onUpdate:modelValue"]),s(e(M),{variant:"outline",size:"icon-sm",onClick:g=>f("increment",t.boxId,a.id)},{default:b(()=>[s(e(Z),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128)),t.laborTypes.length===0?(l(),c("div",He," 등록된 직종이 없습니다. ")):te("",!0)],64)):(l(),c("div",je," 협력업체를 선택해주세요. "))])]))}}),Pe={class:"border border-border rounded-lg bg-card"},Ge={class:"flex items-center justify-between px-4 py-3 border-b border-border bg-muted/50"},Ke={key:0,class:"font-medium text-sm"},Ye={key:1,class:"flex-1 mr-4"},Xe={class:"p-4 space-y-3"},Je={key:0,class:"flex items-center justify-center py-4"},Oe={key:1,class:"text-center text-muted-foreground text-sm py-2"},Qe={class:"flex items-center justify-between"},Ze={class:"text-sm text-muted-foreground"},et={class:"flex items-center gap-3 pl-2"},tt={class:"flex items-center gap-1"},nt={class:"flex items-center gap-1"},ot={class:"flex items-center gap-1"},at={key:0},st={key:1,class:"text-center text-muted-foreground text-sm py-2"},it=oe({__name:"EquipmentCountBox",props:{boxId:{},companyId:{},companyName:{},selectedSpecs:{},allEquipmentSpecs:{},isLoading:{type:Boolean},contractors:{},getCount:{type:Function},getWorkTime:{type:Function}},emits:["remove","selectCompany","addSpec","removeSpec","incrementCount","decrementCount","setCount","incrementWorkTime","decrementWorkTime","setWorkTime","setFullDay","setHalfDay"],setup(t,{emit:v}){const $=t,f=v,E=ae(()=>{const g=new Set($.selectedSpecs.map(_=>_.id));return $.allEquipmentSpecs.filter(_=>!g.has(_.id))});function x(g){g&&f("selectCompany",$.boxId,String(g))}function n(g){g&&f("addSpec",$.boxId,Number(g))}function y(g,_){const p=parseInt(String(_),10);f("setCount",$.boxId,g,isNaN(p)?0:p)}function a(g,_){const p=parseFloat(String(_));f("setWorkTime",$.boxId,g,isNaN(p)?0:p)}return(g,_)=>(l(),c("div",Pe,[i("div",Ge,[t.companyId?(l(),c("div",Ke,N(t.companyName),1)):(l(),c("div",Ye,[s(e(ye),{"onUpdate:modelValue":x},{default:b(()=>[s(e(de),null,{default:b(()=>[s(e(ue),{placeholder:"협력업체 선택"})]),_:1}),s(e(me),null,{default:b(()=>[(l(!0),c(z,null,j(t.contractors,p=>(l(),ee(e(pe),{key:p.companyId,value:p.companyId},{default:b(()=>[V(N(p.companyDisplayName),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])),s(e(M),{variant:"ghost",size:"icon-sm",onClick:_[0]||(_[0]=p=>f("remove",t.boxId))},{default:b(()=>[s(e(fe),{class:"w-4 h-4"})]),_:1})]),i("div",Xe,[t.isLoading?(l(),c("div",Je,[s(e(ge),{class:"w-5 h-5 animate-spin text-muted-foreground"}),_[1]||(_[1]=i("span",{class:"ml-2 text-sm text-muted-foreground"},"장비 목록 로딩중...",-1))])):t.companyId?(l(),c(z,{key:2},[(l(!0),c(z,null,j(t.selectedSpecs,p=>(l(),c("div",{key:p.id,class:"space-y-1"},[i("div",Qe,[i("span",Ze,N(p.equipmentTypeName)+" - "+N(p.name),1),s(e(M),{variant:"ghost",size:"icon-sm",class:"h-5 w-5",onClick:D=>f("removeSpec",t.boxId,p.id)},{default:b(()=>[s(e(fe),{class:"w-3 h-3"})]),_:1},8,["onClick"])]),i("div",et,[i("div",tt,[s(e(M),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:D=>f("setFullDay",t.boxId,p.id)},{default:b(()=>[..._[2]||(_[2]=[V(" 전일 ",-1)])]),_:1},8,["onClick"]),s(e(M),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:D=>f("setHalfDay",t.boxId,p.id)},{default:b(()=>[..._[3]||(_[3]=[V(" 반일 ",-1)])]),_:1},8,["onClick"])]),i("div",nt,[s(e(M),{variant:"outline",size:"icon-sm",onClick:D=>f("decrementWorkTime",t.boxId,p.id)},{default:b(()=>[s(e(ie),{class:"w-3 h-3"})]),_:1},8,["onClick"]),s(e(se),{type:"number",class:"w-16 text-center h-7 text-sm","model-value":t.getWorkTime(t.boxId,p.id),min:"0",step:"0.5","onUpdate:modelValue":D=>a(p.id,D)},null,8,["model-value","onUpdate:modelValue"]),s(e(M),{variant:"outline",size:"icon-sm",onClick:D=>f("incrementWorkTime",t.boxId,p.id)},{default:b(()=>[s(e(Z),{class:"w-3 h-3"})]),_:1},8,["onClick"]),_[4]||(_[4]=i("span",{class:"text-xs text-muted-foreground"},"시간",-1))]),i("div",ot,[s(e(M),{variant:"outline",size:"icon-sm",onClick:D=>f("decrementCount",t.boxId,p.id)},{default:b(()=>[s(e(ie),{class:"w-3 h-3"})]),_:1},8,["onClick"]),s(e(se),{type:"number",class:"w-14 text-center h-7 text-sm","model-value":t.getCount(t.boxId,p.id),min:"0","onUpdate:modelValue":D=>y(p.id,D)},null,8,["model-value","onUpdate:modelValue"]),s(e(M),{variant:"outline",size:"icon-sm",onClick:D=>f("incrementCount",t.boxId,p.id)},{default:b(()=>[s(e(Z),{class:"w-3 h-3"})]),_:1},8,["onClick"]),_[5]||(_[5]=i("span",{class:"text-xs text-muted-foreground"},"대",-1))])])]))),128)),E.value.length>0?(l(),c("div",at,[s(e(ye),{"onUpdate:modelValue":n},{default:b(()=>[s(e(de),{class:"h-8"},{default:b(()=>[s(e(ue),{placeholder:"+ 장비 추가"})]),_:1}),s(e(me),null,{default:b(()=>[(l(!0),c(z,null,j(E.value,p=>(l(),ee(e(pe),{key:p.id,value:String(p.id)},{default:b(()=>[V(N(p.equipmentTypeName)+" - "+N(p.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])):te("",!0),t.selectedSpecs.length===0&&E.value.length===0?(l(),c("div",st," 등록된 장비규격이 없습니다. ")):te("",!0)],64)):(l(),c("div",Oe," 협력업체를 선택해주세요. "))])]))}}),lt={class:"h-full flex flex-col"},rt={key:0,class:"flex-1 flex items-center justify-center"},ct={key:1,class:"flex-1 flex items-center justify-center"},dt={key:2,class:"flex-1 overflow-y-auto space-y-3"},ut={class:"px-4 py-2 border-b border-border bg-muted/50"},mt={class:"font-medium text-sm"},pt={class:"p-4 space-y-3"},yt={key:0},ft={class:"space-y-1"},vt={class:"text-muted-foreground"},gt={class:"font-medium"},xt={key:1},bt={class:"space-y-1"},ht={class:"text-muted-foreground"},kt={class:"font-medium"},wt=oe({__name:"TodayAttendanceBox",props:{attendances:{},isLoading:{type:Boolean},equipmentDeployments:{default:()=>[]},isLoadingEquipment:{type:Boolean,default:!1}},setup(t){const v=t,$=ae(()=>{const x=new Map;for(const n of v.attendances)x.has(n.companyId)||x.set(n.companyId,{companyId:n.companyId,companyDisplayName:n.companyDisplayName,laborItems:[],equipmentItems:[]}),x.get(n.companyId).laborItems.push(n);for(const n of v.equipmentDeployments)x.has(n.companyId)||x.set(n.companyId,{companyId:n.companyId,companyDisplayName:n.companyDisplayName,laborItems:[],equipmentItems:[]}),x.get(n.companyId).equipmentItems.push(n);return Array.from(x.values())}),f=ae(()=>v.attendances.length===0&&v.equipmentDeployments.length===0),E=ae(()=>v.isLoading||v.isLoadingEquipment);return(x,n)=>(l(),c("div",lt,[E.value?(l(),c("div",rt,[s(e(ge),{class:"w-5 h-5 animate-spin text-muted-foreground"}),n[0]||(n[0]=i("span",{class:"ml-2 text-sm text-muted-foreground"},"로딩중...",-1))])):f.value?(l(),c("div",ct,[...n[1]||(n[1]=[i("p",{class:"text-sm text-muted-foreground"},"등록된 출역 정보가 없습니다.",-1)])])):(l(),c("div",dt,[(l(!0),c(z,null,j($.value,y=>(l(),c("div",{key:y.companyId,class:"border border-border rounded-lg bg-card"},[i("div",ut,[i("span",mt,N(y.companyDisplayName),1)]),i("div",pt,[y.laborItems.length>0?(l(),c("div",yt,[n[2]||(n[2]=i("p",{class:"text-xs text-muted-foreground font-medium mb-1"},"오늘 출역 인원",-1)),i("div",ft,[(l(!0),c(z,null,j(y.laborItems,a=>(l(),c("div",{key:`labor-${a.companyId}-${a.laborTypeId}`,class:"flex items-center justify-between text-sm pl-2"},[i("span",vt,N(a.laborTypeName),1),i("span",gt,N(a.count)+"명",1)]))),128))])])):te("",!0),y.equipmentItems.length>0?(l(),c("div",xt,[n[3]||(n[3]=i("p",{class:"text-xs text-muted-foreground font-medium mb-1"},"오늘 출역 장비",-1)),i("div",bt,[(l(!0),c(z,null,j(y.equipmentItems,a=>(l(),c("div",{key:`equip-${a.companyId}-${a.equipmentSpecId}`,class:"flex items-center justify-between text-sm pl-2"},[i("span",ht,N(a.equipmentTypeName)+" "+N(a.equipmentSpecName),1),i("span",kt,N(a.count)+"대 "+N(a.workTime)+"시간",1)]))),128))])])):te("",!0)])]))),128))]))]))}}),Ct={class:"flex flex-col h-full"},$t={class:"flex items-center justify-center gap-2 py-4 border-b border-border"},_t={class:"flex-1 overflow-hidden grid grid-cols-3 gap-4 p-4"},Tt={class:"flex flex-col overflow-hidden border border-border rounded-lg bg-card"},It={class:"flex-1 overflow-y-auto p-4"},St={class:"flex flex-col overflow-hidden border border-border rounded-lg bg-card"},qt={class:"flex-1 overflow-y-auto p-4"},Dt={key:0,class:"flex items-center justify-center h-full"},Nt={key:1,class:"space-y-4"},Et={class:"flex items-center justify-between px-4 py-3 border-t border-border"},Lt={class:"flex flex-col overflow-hidden border border-border rounded-lg bg-card"},Bt={class:"flex-1 overflow-y-auto p-4"},Mt={key:0,class:"flex items-center justify-center h-full"},Wt={key:1,class:"space-y-4"},At={class:"flex items-center justify-between px-4 py-3 border-t border-border"},zt=oe({__name:"AttendanceTab",setup(t){const{selectedDate:v,isSubmitting:$,todayAttendance:f,isLoadingToday:E,contractors:x,workTypeBoxes:n,addEmptyBox:y,selectCompany:a,removeWorkTypeBox:g,getCount:_,incrementCount:p,decrementCount:D,setCount:X,submitAttendance:U,init:P}=De(),{isSubmittingEquipment:J,allEquipmentSpecs:G,todayEquipment:K,isLoadingEquipment:ne,equipmentBoxes:d,addEmptyBox:k,selectCompany:m,removeEquipmentBox:w,addSpecToBox:L,removeSpecFromBox:T,getCount:Y,incrementCount:F,decrementCount:H,setCount:R,getWorkTime:O,incrementWorkTime:o,decrementWorkTime:r,setWorkTime:u,setFullDay:C,setHalfDay:I,submitEquipmentDeployment:W,init:B}=Ee(v,x);function q(Q){const h=new Date(v.value);h.setDate(h.getDate()+Q);const S=h.getFullYear(),Ce=String(h.getMonth()+1).padStart(2,"0"),$e=String(h.getDate()).padStart(2,"0");v.value=`${S}-${Ce}-${$e}`}return Ie(async()=>{await P(),await B()}),(Q,h)=>(l(),c("div",Ct,[i("div",$t,[s(e(M),{variant:"outline",size:"icon-sm",onClick:h[0]||(h[0]=S=>q(-1))},{default:b(()=>[s(e(ie),{class:"w-4 h-4"})]),_:1}),s(e(se),{modelValue:e(v),"onUpdate:modelValue":h[1]||(h[1]=S=>Se(v)?v.value=S:null),type:"date",class:"w-48"},null,8,["modelValue"]),s(e(M),{variant:"outline",size:"icon-sm",onClick:h[2]||(h[2]=S=>q(1))},{default:b(()=>[s(e(Z),{class:"w-4 h-4"})]),_:1})]),i("div",_t,[i("div",Tt,[h[3]||(h[3]=i("div",{class:"px-4 py-3 border-b border-border bg-muted/50"},[i("h3",{class:"text-sm font-medium"},"오늘 출역")],-1)),i("div",It,[s(wt,{attendances:e(f),"is-loading":e(E),"equipment-deployments":e(K),"is-loading-equipment":e(ne)},null,8,["attendances","is-loading","equipment-deployments","is-loading-equipment"])])]),i("div",St,[h[6]||(h[6]=i("div",{class:"px-4 py-3 border-b border-border bg-muted/50"},[i("h3",{class:"text-sm font-medium"},"출역인원 입력")],-1)),i("div",qt,[e(n).length===0?(l(),c("div",Dt,[...h[4]||(h[4]=[i("p",{class:"text-muted-foreground text-sm"},"추가 버튼을 눌러 업체를 추가하세요.",-1)])])):(l(),c("div",Nt,[(l(!0),c(z,null,j(e(n),S=>(l(),ee(Re,{key:S.id,"box-id":S.id,"company-id":S.companyId,"company-name":S.companyName,"work-type-name":S.workTypeName,"labor-types":S.laborTypes,"is-loading":S.isLoading,contractors:e(x),"get-count":e(_),onRemove:e(g),onSelectCompany:e(a),onIncrement:e(p),onDecrement:e(D),onSetCount:e(X)},null,8,["box-id","company-id","company-name","work-type-name","labor-types","is-loading","contractors","get-count","onRemove","onSelectCompany","onIncrement","onDecrement","onSetCount"]))),128))]))]),i("div",Et,[s(e(M),{size:"sm",onClick:e(y)},{default:b(()=>[s(e(Z),{class:"w-4 h-4 mr-2"}),h[5]||(h[5]=V(" 추가 ",-1))]),_:1},8,["onClick"]),s(e(M),{size:"lg",disabled:e(n).length===0||e($),onClick:e(U)},{default:b(()=>[V(N(e($)?"저장 중...":"제출"),1)]),_:1},8,["disabled","onClick"])])]),i("div",Lt,[h[9]||(h[9]=i("div",{class:"px-4 py-3 border-b border-border bg-muted/50"},[i("h3",{class:"text-sm font-medium"},"출역장비 입력")],-1)),i("div",Bt,[e(d).length===0?(l(),c("div",Mt,[...h[7]||(h[7]=[i("p",{class:"text-muted-foreground text-sm"},"추가 버튼을 눌러 업체를 추가하세요.",-1)])])):(l(),c("div",Wt,[(l(!0),c(z,null,j(e(d),S=>(l(),ee(it,{key:S.id,"box-id":S.id,"company-id":S.companyId,"company-name":S.companyName,"selected-specs":S.selectedSpecs,"all-equipment-specs":e(G),"is-loading":S.isLoading,contractors:e(x),"get-count":e(Y),"get-work-time":e(O),onRemove:e(w),onSelectCompany:e(m),onAddSpec:e(L),onRemoveSpec:e(T),onIncrementCount:e(F),onDecrementCount:e(H),onSetCount:e(R),onIncrementWorkTime:e(o),onDecrementWorkTime:e(r),onSetWorkTime:e(u),onSetFullDay:e(C),onSetHalfDay:e(I)},null,8,["box-id","company-id","company-name","selected-specs","all-equipment-specs","is-loading","contractors","get-count","get-work-time","onRemove","onSelectCompany","onAddSpec","onRemoveSpec","onIncrementCount","onDecrementCount","onSetCount","onIncrementWorkTime","onDecrementWorkTime","onSetWorkTime","onSetFullDay","onSetHalfDay"]))),128))]))]),i("div",At,[s(e(M),{size:"sm",onClick:e(k)},{default:b(()=>[s(e(Z),{class:"w-4 h-4 mr-2"}),h[8]||(h[8]=V(" 추가 ",-1))]),_:1},8,["onClick"]),s(e(M),{size:"lg",disabled:e(d).length===0||e(J),onClick:e(W)},{default:b(()=>[V(N(e(J)?"저장 중...":"제출"),1)]),_:1},8,["disabled","onClick"])])])])]))}}),Zt=oe({__name:"ListPage",setup(t){const v=[{value:"attendance",label:"출역관리"},{value:"register",label:"작업자 등록"}];return($,f)=>(l(),ee(_e,{title:"출역관리"},{default:b(()=>[s(Te,{height:"flex-1","has-tabs":!0,tabs:v,"default-tab":"attendance"},{"tab-attendance":b(()=>[s(zt)]),"tab-register":b(()=>[...f[0]||(f[0]=[i("div",{class:"flex-1 flex items-center justify-center border border-dashed border-border rounded-lg"},[i("p",{class:"text-muted-foreground"},"작업자 등록 (구현 예정)")],-1)])]),_:1})]),_:1}))}});export{Zt as default};
