import{r as c,d as Ct,O as re,y as ne,i as Lt,I as Vt,p as w,w as o,e as s,a as n,c as d,u as l,g as u,F as p,n as _,j as y,t as m,o as i,k as qe,q as ze,z as St,Q as Et}from"./index-CrXngJox.js";import{_ as Nt}from"./PageContainer.vue_vue_type_script_setup_true_lang-CEHe9PLv.js";import{_ as Mt}from"./AreaCard.vue_vue_type_script_setup_true_lang-Cun49brn.js";import{_ as k}from"./index-DjQGxc2-.js";import{_ as Ae,a as Qe,b as Ge,c as ve,d as L,e as He,f as V}from"./TableHeader.vue_vue_type_script_setup_true_lang-CSVUziB3.js";import{a as Je,b as Ke,c as et,d as tt,_ as lt}from"./DialogTitle.vue_vue_type_script_setup_true_lang-BB_oSIsK.js";import{_ as M}from"./Checkbox.vue_vue_type_script_setup_true_lang-CQl3bHDA.js";import{_ as g}from"./Label.vue_vue_type_script_setup_true_lang-zcirpsqi.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-Cd6-xZ_U.js";import{_ as pe,a as ge,b as _e,c as ye,d as xe}from"./SelectValue.vue_vue_type_script_setup_true_lang-jGZzJRNu.js";import{a as Ot,b as Tt,c as Pt,d as Rt,e as jt,f as Ft,g as qt,_ as zt}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BMpptCBF.js";import{m as T}from"./materialOrder-Nqo9WW5x.js";import{m as Be}from"./projectDocumentCode-DWNk8c3X.js";import{r as O}from"./reference-BgrhXxFd.js";import{X as At}from"./x-CqUQJ7je.js";import"./Collection-7xKaQT2u.js";import"./index-DbURNFAQ.js";import"./utils-BjnBM6mg.js";import"./DialogTitle-Bfgltyr_.js";import"./createLucideIcon-BNaNAPpz.js";import"./apiClient-ycqybHFy.js";function Bt(){const De=c([]),P=c(!1);async function be(){P.value=!0;try{const S=await T.getMaterialOrderList();De.value=S.sort((U,R)=>new Date(R.createdAt).getTime()-new Date(U.createdAt).getTime())}catch(S){console.error("발주서 목록 로드 실패:",S);const U=S;alert(U.response?.data?.message||U.message)}finally{P.value=!1}}return{orders:De,isLoading:P,loadOrders:be}}const Wt={key:0,class:"text-sm text-muted-foreground text-center py-8"},Zt={key:1,class:"flex items-center justify-center py-16 border border-dashed border-border rounded-lg"},Xt={key:2,class:"space-y-4"},Yt=["onClick"],Qt={class:"text-xs text-muted-foreground"},Gt={class:"text-sm font-medium"},Ht={class:"text-xs text-muted-foreground"},Jt={class:"text-sm font-medium bg-muted/30 border border-foreground px-2 py-0.5 rounded"},Kt={key:0,class:"flex items-center gap-2 flex-wrap"},el={class:"font-semibold ml-1"},tl={class:"text-muted-foreground ml-0.5"},ll={key:0,class:"overflow-x-auto"},al={class:"flex justify-end mb-4"},sl={key:0,class:"text-sm text-muted-foreground text-center py-8"},ol={key:1,class:"flex items-center justify-center py-16 border border-dashed border-border rounded-lg"},rl={key:2,class:"space-y-4"},nl=["onClick"],il={class:"text-xs text-muted-foreground"},ul={class:"text-sm font-medium"},dl={class:"text-sm text-muted-foreground"},cl={class:"text-sm text-muted-foreground"},ml={key:0,class:"text-sm text-muted-foreground"},fl={key:0,class:"p-4"},vl={key:0,class:"text-sm text-muted-foreground text-center py-8"},pl={key:1,class:"flex gap-4"},gl={class:"w-1/2 flex flex-col gap-2"},_l={key:0,class:"h-[720px] flex items-center justify-center border border-border rounded-lg bg-muted/20"},yl=["onWheel","onPointerdown","onPointermove","onPointerup","onPointercancel"],xl=["src"],Dl={class:"absolute bottom-2 right-2 flex items-center gap-1 bg-background/80 rounded-md border border-border px-1.5 py-0.5"},bl={class:"text-xs text-muted-foreground min-w-[3ch] text-center"},hl={key:0,class:"shrink-0"},kl={key:1,class:"flex items-center justify-center gap-3 shrink-0"},Il={class:"text-sm text-muted-foreground"},$l={key:2,class:"h-[720px] flex items-center justify-center border border-border rounded-lg bg-muted/20"},wl={class:"w-1/2 space-y-4 overflow-y-auto"},Ul={class:"grid grid-cols-3 gap-4"},Cl={class:"space-y-1.5"},Ll={class:"space-y-1.5"},Vl={class:"space-y-1.5"},Sl={class:"overflow-x-auto border border-border rounded-lg"},El={class:"flex items-center gap-1.5"},Nl={key:0,class:"shrink-0 text-green-600 dark:text-green-400 text-xs font-medium",title:"규격 검증 성공"},Ml={key:1,class:"shrink-0 text-yellow-600 dark:text-yellow-400 text-xs font-medium",title:"규격 검증 실패"},Ol={class:"flex items-center gap-1"},Tl={class:"text-sm text-muted-foreground shrink-0"},Pl={class:"flex justify-end"},Rl={class:"space-y-5 py-2"},jl={class:"space-y-2"},Fl={class:"space-y-2"},ql={key:0,class:"space-y-2"},zl={class:"flex flex-wrap gap-3"},Al=["for"],Bl={key:1,class:"space-y-2"},Wl={class:"flex flex-wrap gap-3"},Zl=["for"],Xl={key:2,class:"space-y-2"},Yl={class:"flex flex-wrap gap-3"},Ql=["for"],Gl={key:3,class:"space-y-2"},Hl={class:"flex flex-wrap gap-3"},Jl=["for"],Kl={class:"flex gap-2"},ea={key:0,class:"text-sm text-muted-foreground"},ta={class:"space-y-5 py-2"},la={class:"space-y-2"},aa={class:"space-y-2"},sa={class:"space-y-2"},oa={class:"space-y-2"},ra={class:"space-y-2"},na={key:0,class:"space-y-2"},ia={class:"flex flex-wrap gap-3"},ua=["for"],da={key:1,class:"space-y-2"},ca={class:"flex flex-wrap gap-3"},ma=["for"],fa={key:2,class:"space-y-2"},va={class:"flex flex-wrap gap-3"},pa=["for"],ga={key:3,class:"space-y-2"},_a={class:"flex flex-wrap gap-3"},ya=["for"],xa={class:"flex gap-2"},Da={key:0,class:"text-sm text-muted-foreground"},za=Ct({__name:"InvoicePage",setup(De){const{orders:P,isLoading:be,loadOrders:S}=Bt(),U=re({}),R=c(!1),I=c(null),he=c([]),ke=c([]),A=c([]),B=c([]),W=c([]),Z=c([]),X=c(!1),Y=c(!1),Q=c(""),F=c(""),q=c(""),We=c([]),Ze=c([]),ie=c([]),ue=c(!1),G=c(!1),Ie=c([]),$e=c([]),we=c([]),Ue=c([]),Ce=c([]),Le=c([]),H=c([]),J=c([]),K=c([]),ee=c([]),de=c(!1),Ve=c(null),Xe=c(""),te=c(!1),Se=c([]),Ee=c(!1),C=re({}),z=c({}),x=c({}),Ne=c({}),ce=c({}),le=c([]),b=c({}),h=c({}),Me=c({}),D=c({}),$=re({}),E=c({}),ae=re({}),se=re({}),Oe=c([]),at=ne(()=>new Set(Oe.value.map(a=>a.materialDeliveryId))),me=c({}),Te=ne(()=>{if(!I.value)return[];const a=new Map;return I.value.orderLines.forEach(e=>{e.zoneId!=null&&e.zoneName&&a.set(e.zoneId,e.zoneName)}),Array.from(a,([e,t])=>({id:e,name:t}))}),Pe=ne(()=>{if(!I.value)return[];const a=new Map;return I.value.orderLines.forEach(e=>{e.floorId!=null&&e.floorName&&a.set(e.floorId,e.floorName)}),Array.from(a,([e,t])=>({id:e,name:t}))}),Re=ne(()=>{if(!I.value)return[];const a=new Map;return I.value.orderLines.forEach(e=>{e.sectionId!=null&&e.sectionName&&a.set(e.sectionId,e.sectionName)}),Array.from(a,([e,t])=>({id:e,name:t}))}),je=ne(()=>{if(!I.value)return[];const a=new Map;return I.value.orderLines.forEach(e=>{e.usageId!=null&&e.usageName&&a.set(e.usageId,e.usageName)}),Array.from(a,([e,t])=>({id:e,name:t}))});function st(a){if(U[a])U[a]=!1;else{for(const e of Object.keys(U))U[Number(e)]=!1;U[a]=!0}}async function ot(a){I.value=a,he.value=[],ke.value=[],await Et(),A.value=Te.value.map(e=>e.id),B.value=Pe.value.map(e=>e.id),W.value=Re.value.map(e=>e.id),Z.value=je.value.map(e=>e.id),R.value=!0}function rt(a){const e=a.target;he.value=e.files?Array.from(e.files):[]}function nt(a){const e=a.target;ke.value=e.files?Array.from(e.files):[]}function N(a,e){return a.includes(e)?a.filter(t=>t!==e):[...a,e]}async function it(){if(I.value){X.value=!0;try{await T.createMaterialDelivery({orderId:I.value.id,materialTypeId:I.value.materialTypeId,workTypeId:I.value.workTypeId,deliveryNotes:he.value,deliveryPhotos:ke.value,zoneIds:A.value,floorIds:B.value,sectionIds:W.value,usageIds:Z.value}),R.value=!1,S(),oe()}catch(a){console.error("송장입력 실패:",a);const e=a;alert(e.response?.data?.message||e.message)}finally{X.value=!1}}}async function ut(){Ie.value=[],$e.value=[],Q.value="",F.value="",q.value="",ie.value=[],H.value=[],J.value=[],K.value=[],ee.value=[];try{const[a,e,t,r,f,v]=await Promise.all([O.getMaterialTypeList(),O.getDivisionList(),O.getZoneList(),O.getFloorList(),O.getSectionList(),O.getUsageList()]);We.value=a,Ze.value=e,we.value=t,Ue.value=r,Ce.value=f,Le.value=v}catch(a){console.error("기초 데이터 로드 실패:",a);const e=a;alert(e.response?.data?.message||e.message);return}Y.value=!0}async function dt(a){if(F.value=String(a??""),q.value="",ie.value=[],!!F.value){ue.value=!0;try{ie.value=await O.getWorkTypeList(Number(F.value))}catch(e){console.error("공종 목록 로드 실패:",e)}finally{ue.value=!1}}}function ct(a){const e=a.target;Ie.value=e.files?Array.from(e.files):[]}function mt(a){const e=a.target;$e.value=e.files?Array.from(e.files):[]}async function ft(){if(!Q.value){alert("자재유형을 선택해주세요.");return}G.value=!0;try{await T.createMaterialDelivery({materialTypeId:Number(Q.value),workTypeId:q.value?Number(q.value):void 0,deliveryNotes:Ie.value,deliveryPhotos:$e.value,zoneIds:H.value,floorIds:J.value,sectionIds:K.value,usageIds:ee.value}),Y.value=!1,oe()}catch(a){console.error("송장입력 실패:",a);const e=a;alert(e.response?.data?.message||e.message)}finally{G.value=!1}}function vt(a,e){Ve.value=a,Xe.value=e,de.value=!0}async function pt(){if(Ve.value!=null){te.value=!0;try{await T.deleteMaterialDelivery(Ve.value),de.value=!1,oe(),S()}catch(a){console.error("반입자재 삭제 실패:",a);const e=a;alert(e.response?.data?.message||e.message)}finally{te.value=!1}}}async function gt(a){me.value[a]=!0;try{await Be.createMaterialInspectionRequest(a),Oe.value=await Be.getMaterialInspectionRequestList()}catch(e){console.error("자재반입검수요청서 생성 실패:",e);const t=e;alert(t.response?.data?.message||t.message)}finally{me.value[a]=!1}}async function _t(a){const e=a.materialDeliveryId;if(C[e]){C[e]=!1,b.value[e]?.forEach(t=>URL.revokeObjectURL(t)),delete z.value[e],delete x.value[e],delete b.value[e],delete h.value[e],delete D.value[e],delete $[e],delete E.value[e],delete ae[e],delete se[e];return}for(const t of Object.keys(C)){const r=Number(t);C[r]&&(C[r]=!1,b.value[r]?.forEach(f=>URL.revokeObjectURL(f)),delete z.value[r],delete x.value[r],delete b.value[r],delete h.value[r],delete D.value[r],delete $[r],delete E.value[r],delete ae[r],delete se[r])}C[e]=!0,Ne.value[e]=!0;try{const t=await T.getMaterialDeliveryLineList(e);if(z.value[e]=t,x.value[e]={supplier:a.supplier,deliveryDate:a.deliveryDate,location:a.location??"",noteDescriptions:a.noteFiles.map(f=>({noteId:f.noteId,description:f.description})),photoDescriptions:a.photoFiles.map(f=>({photoId:f.photoId,description:f.description}))},h.value[e]=0,D.value[e]=1,$[e]={x:0,y:0},E.value[e]=!1,ae[e]={x:0,y:0},se[e]={x:0,y:0},le.value.length===0){const f=P.value.find(v=>v.id===a.materialOrderId);if(f?.materialTypeId)try{le.value=await O.getMaterialSpecList(f.materialTypeId)}catch{le.value=[]}}const r=[...a.noteFiles.map(f=>f.url),...a.photoFiles.map(f=>f.url)];if(r.length>0){Me.value[e]=!0;try{const f=await Promise.all(r.map(v=>T.getDeliveryNoteImage(v)));b.value[e]=f}catch(f){console.error("송장 이미지 로드 실패:",f),b.value[e]=[]}finally{Me.value[e]=!1}}}catch(t){console.error("반입자재 라인 로드 실패:",t);const r=t;alert(r.response?.data?.message||r.message),C[e]=!1}finally{Ne.value[e]=!1}}function Fe(a){D.value[a]=1,$[a]&&($[a].x=0,$[a].y=0)}function yt(a,e){e.preventDefault();const t=e.deltaY>0?-.1:.1,r=D.value[a]??1;D.value[a]=Math.min(5,Math.max(.5,r+t))}function xt(a,e){if((D.value[a]??1)<=1)return;E.value[a]=!0,ae[a]={x:e.clientX,y:e.clientY};const r=$[a]??{x:0,y:0};se[a]={x:r.x,y:r.y},e.target.setPointerCapture(e.pointerId)}function Dt(a,e){if(!E.value[a])return;const t=ae[a],r=se[a];t&&r&&$[a]&&($[a].x=r.x+(e.clientX-t.x),$[a].y=r.y+(e.clientY-t.y))}function Ye(a){E.value[a]=!1}function bt(a){const e=b.value[a]??[];if(e.length===0)return;const t=h.value[a]??0;h.value[a]=t>0?t-1:e.length-1,Fe(a)}function ht(a){const e=b.value[a]??[];if(e.length===0)return;const t=h.value[a]??0;h.value[a]=t<e.length-1?t+1:0,Fe(a)}async function kt(a){const e=a.materialDeliveryId,t=x.value[e],r=z.value[e];if(!(!t||!r)){ce.value[e]=!0;try{await T.updateMaterialDelivery(e,{supplier:t.supplier,deliveryDate:t.deliveryDate,location:t.location||null,deliveryLines:r.map(f=>({deliveryLineId:f.deliveryLineId,manufacturer:f.manufacturer,specId:f.materialSpecId,quantity:String(f.quantity)})),noteDescriptions:t.noteDescriptions,photoDescriptions:t.photoDescriptions}),C[e]=!1,b.value[e]?.forEach(f=>URL.revokeObjectURL(f)),delete z.value[e],delete x.value[e],delete b.value[e],delete h.value[e],delete D.value[e],delete $[e],oe()}catch(f){console.error("반입자재 수정 실패:",f);const v=f;alert(v.response?.data?.message||v.message)}finally{ce.value[e]=!1}}}async function oe(){Ee.value=!0;try{Se.value=await T.getMaterialDeliveryList()}catch(a){console.error("반입자재 목록 로딩 실패:",a);const e=a;alert(e.response?.data?.message||e.message)}finally{Ee.value=!1}}Lt(()=>{S(),oe(),Be.getMaterialInspectionRequestList().then(a=>Oe.value=a).catch(()=>{})}),Vt(()=>{Object.values(b.value).forEach(a=>{a.forEach(e=>URL.revokeObjectURL(e))})});function It(a){switch(a){case"BEFORE_ORDER":return"발주전";case"ORDER_COMPLETED":return"발주완료";case"RECEIPT_COMPLETED":return"반입완료";default:return a}}function $t(a){switch(a){case"BEFORE_ORDER":return"bg-red-500 text-white hover:bg-red-500/80";case"ORDER_COMPLETED":return"bg-green-500 text-white hover:bg-green-500/80";case"RECEIPT_COMPLETED":return"bg-blue-500 text-white hover:bg-blue-500/80";default:return"bg-muted text-muted-foreground"}}function wt(a){const e=[a.zoneName,a.floorName,a.sectionName,a.usageName].filter(Boolean);return e.length>0?e.join(" "):"-"}return(a,e)=>(i(),w(Nt,{title:"자재관리"},{default:o(()=>[s(Mt,{height:"flex-1","min-height":"1100px","has-tabs":!0,tabs:[{value:"order",label:"자재 발주서"},{value:"incoming",label:"반입 자재"},{value:"outgoing",label:"반출 자재"},{value:"remaining",label:"잔여 자재"}],"default-tab":"order"},{"tab-order":o(()=>[l(be)?(i(),d("div",Wt," 발주서 목록 로딩 중... ")):l(P).length===0?(i(),d("div",Zt,[...e[9]||(e[9]=[n("p",{class:"text-muted-foreground"}," 발주서가 없습니다. 3D 공정표에서 부재를 선택하여 발주서를 생성하세요. ",-1)])])):(i(),d("div",Xt,[(i(!0),d(p,null,_(l(P),t=>(i(),d("div",{key:t.id,class:"border border-border rounded-lg overflow-hidden"},[n("div",{class:"flex items-center gap-3 px-4 py-3 bg-muted/30 cursor-pointer select-none",onClick:r=>st(t.id)},[n("span",Qt,m(U[t.id]?"▲":"▼"),1),s(l(Ae),{class:ze(["text-sm px-3 py-1",$t(t.orderStatus)])},{default:o(()=>[u(m(It(t.orderStatus)),1)]),_:2},1032,["class"]),n("span",Gt,m(t.orderNo),1),n("span",Ht,m(t.workTypeName),1),n("span",Jt,m(t.totalQuantity)+" "+m(t.unit),1),t.specSummary?.length>0?(i(),d("div",Kt,[(i(!0),d(p,null,_(t.specSummary,r=>(i(),w(l(Ae),{key:r.materialSpecId,variant:"outline",class:"text-sm px-2.5 py-1"},{default:o(()=>[u(m(r.materialSpecName)+" ",1),n("span",el,m(r.quantity),1),n("span",tl,m(t.unit),1)]),_:2},1024))),128))])):y("",!0),n("div",{class:"flex items-center gap-2 ml-auto",onClick:e[0]||(e[0]=qe(()=>{},["stop"]))},[s(l(k),{variant:"outline",size:"sm",disabled:t.orderStatus==="ORDER_COMPLETED"||t.orderStatus==="RECEIPT_COMPLETED"},{default:o(()=>[...e[10]||(e[10]=[u(" 발주하기 ",-1)])]),_:1},8,["disabled"]),s(l(k),{variant:"outline",size:"sm",disabled:t.orderStatus!=="ORDER_COMPLETED",onClick:r=>ot(t)},{default:o(()=>[...e[11]||(e[11]=[u(" 송장입력 ",-1)])]),_:1},8,["disabled","onClick"])])],8,Yt),U[t.id]?(i(),d("div",ll,[s(l(Qe),null,{default:o(()=>[s(l(Ge),null,{default:o(()=>[s(l(ve),null,{default:o(()=>[s(l(L),null,{default:o(()=>[...e[12]||(e[12]=[u("오브젝트",-1)])]),_:1}),s(l(L),null,{default:o(()=>[...e[13]||(e[13]=[u("자재규격",-1)])]),_:1}),s(l(L),null,{default:o(()=>[...e[14]||(e[14]=[u("부재코드",-1)])]),_:1}),s(l(L),null,{default:o(()=>[...e[15]||(e[15]=[u("세부작업",-1)])]),_:1}),s(l(L),null,{default:o(()=>[...e[16]||(e[16]=[u("위치",-1)])]),_:1}),s(l(L),{class:"text-right"},{default:o(()=>[...e[17]||(e[17]=[u("수량",-1)])]),_:1})]),_:1})]),_:1}),s(l(He),null,{default:o(()=>[(i(!0),d(p,null,_(t.orderLines,r=>(i(),w(l(ve),{key:r.id},{default:o(()=>[s(l(V),{class:"text-sm"},{default:o(()=>[u(m(r.object3dId??"-"),1)]),_:2},1024),s(l(V),{class:"text-sm"},{default:o(()=>[u(m(r.materialSpecName),1)]),_:2},1024),s(l(V),{class:"text-sm"},{default:o(()=>[u(m(r.componentCodeName??"-"),1)]),_:2},1024),s(l(V),{class:"text-sm"},{default:o(()=>[u(m(r.workStepName??"-"),1)]),_:2},1024),s(l(V),{class:"text-sm"},{default:o(()=>[u(m(wt(r)),1)]),_:2},1024),s(l(V),{class:"text-sm text-right"},{default:o(()=>[u(m(r.quantity),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])):y("",!0)]))),128))]))]),"tab-incoming":o(()=>[n("div",al,[s(l(k),{variant:"outline",size:"sm",onClick:ut},{default:o(()=>[...e[18]||(e[18]=[u(" 발주서 없이 송장입력 ",-1)])]),_:1})]),Ee.value?(i(),d("div",sl," 반입자재 목록 로딩 중... ")):Se.value.length===0?(i(),d("div",ol,[...e[19]||(e[19]=[n("p",{class:"text-muted-foreground"},"반입된 자재가 없습니다.",-1)])])):(i(),d("div",rl,[(i(!0),d(p,null,_(Se.value,t=>(i(),d("div",{key:t.materialDeliveryId,class:"border border-border rounded-lg overflow-hidden"},[n("div",{class:"flex items-center gap-3 px-4 py-3 bg-muted/30 cursor-pointer select-none",onClick:r=>_t(t)},[n("span",il,m(C[t.materialDeliveryId]?"▲":"▼"),1),n("span",ul,m(t.materialOrderNumber),1),n("span",dl,m(t.supplier),1),n("span",cl,m(t.deliveryDate),1),t.location?(i(),d("span",ml,m(t.location),1)):y("",!0),n("div",{class:"flex items-center gap-1 ml-auto",onClick:e[1]||(e[1]=qe(()=>{},["stop"]))},[at.value.has(t.materialDeliveryId)?(i(),w(l(Ae),{key:1,variant:"secondary"},{default:o(()=>[...e[20]||(e[20]=[u("검수요청 완료",-1)])]),_:1})):(i(),w(l(k),{key:0,variant:"outline",size:"sm",disabled:me.value[t.materialDeliveryId],onClick:r=>gt(t.materialDeliveryId)},{default:o(()=>[u(m(me.value[t.materialDeliveryId]?"생성 중...":"자재반입검수요청서"),1)]),_:2},1032,["disabled","onClick"])),s(l(k),{variant:"ghost",size:"sm",class:"h-8 w-8 p-0 text-muted-foreground hover:text-destructive",onClick:r=>vt(t.materialDeliveryId,t.materialOrderNumber)},{default:o(()=>[s(l(At),{class:"h-4 w-4"})]),_:1},8,["onClick"])])],8,nl),C[t.materialDeliveryId]?(i(),d("div",fl,[Ne.value[t.materialDeliveryId]?(i(),d("div",vl," 라인 정보 로딩 중... ")):(i(),d("div",pl,[n("div",gl,[Me.value[t.materialDeliveryId]?(i(),d("div",_l,[...e[21]||(e[21]=[n("p",{class:"text-sm text-muted-foreground"},"이미지 로딩 중...",-1)])])):(b.value[t.materialDeliveryId]??[]).length>0?(i(),d(p,{key:1},[n("div",{class:ze(["h-[720px] border border-border rounded-lg overflow-hidden bg-muted/20 relative",{"cursor-grab":(D.value[t.materialDeliveryId]??1)>1,"cursor-grabbing":E.value[t.materialDeliveryId]}]),onWheel:qe(r=>yt(t.materialDeliveryId,r),["prevent"]),onPointerdown:r=>xt(t.materialDeliveryId,r),onPointermove:r=>Dt(t.materialDeliveryId,r),onPointerup:r=>Ye(t.materialDeliveryId),onPointercancel:r=>Ye(t.materialDeliveryId)},[n("img",{src:b.value[t.materialDeliveryId]?.[h.value[t.materialDeliveryId]??0],alt:"송장 이미지",class:"w-full h-full object-contain select-none",draggable:"false",style:St({transform:`translate(${$[t.materialDeliveryId]?.x??0}px, ${$[t.materialDeliveryId]?.y??0}px) scale(${D.value[t.materialDeliveryId]??1})`,transformOrigin:"center center",transition:E.value[t.materialDeliveryId]?"none":"transform 0.15s ease"})},null,12,xl),n("div",Dl,[s(l(k),{variant:"ghost",size:"sm",class:"h-6 w-6 p-0",onClick:r=>D.value[t.materialDeliveryId]=Math.max(.5,(D.value[t.materialDeliveryId]??1)-.25)},{default:o(()=>[...e[22]||(e[22]=[u("−",-1)])]),_:1},8,["onClick"]),n("span",bl,m(Math.round((D.value[t.materialDeliveryId]??1)*100))+"%",1),s(l(k),{variant:"ghost",size:"sm",class:"h-6 w-6 p-0",onClick:r=>D.value[t.materialDeliveryId]=Math.min(5,(D.value[t.materialDeliveryId]??1)+.25)},{default:o(()=>[...e[23]||(e[23]=[u("+",-1)])]),_:1},8,["onClick"]),(D.value[t.materialDeliveryId]??1)!==1?(i(),w(l(k),{key:0,variant:"ghost",size:"sm",class:"h-6 px-1 text-xs",onClick:r=>Fe(t.materialDeliveryId)},{default:o(()=>[...e[24]||(e[24]=[u("초기화",-1)])]),_:1},8,["onClick"])):y("",!0)])],42,yl),x.value[t.materialDeliveryId]?(i(),d("div",hl,[(h.value[t.materialDeliveryId]??0)<t.noteFiles.length?(i(),w(l(j),{key:0,modelValue:x.value[t.materialDeliveryId].noteDescriptions[h.value[t.materialDeliveryId]??0].description,"onUpdate:modelValue":r=>x.value[t.materialDeliveryId].noteDescriptions[h.value[t.materialDeliveryId]??0].description=r,class:"h-8 text-sm",placeholder:"송장 설명"},null,8,["modelValue","onUpdate:modelValue"])):(i(),w(l(j),{key:1,modelValue:x.value[t.materialDeliveryId].photoDescriptions[(h.value[t.materialDeliveryId]??0)-t.noteFiles.length].description,"onUpdate:modelValue":r=>x.value[t.materialDeliveryId].photoDescriptions[(h.value[t.materialDeliveryId]??0)-t.noteFiles.length].description=r,class:"h-8 text-sm",placeholder:"사진 설명"},null,8,["modelValue","onUpdate:modelValue"]))])):y("",!0),(b.value[t.materialDeliveryId]??[]).length>1?(i(),d("div",kl,[s(l(k),{variant:"outline",size:"sm",onClick:r=>bt(t.materialDeliveryId)},{default:o(()=>[...e[25]||(e[25]=[u(" ← 이전 ",-1)])]),_:1},8,["onClick"]),n("span",Il,m((h.value[t.materialDeliveryId]??0)+1)+" / "+m((b.value[t.materialDeliveryId]??[]).length),1),s(l(k),{variant:"outline",size:"sm",onClick:r=>ht(t.materialDeliveryId)},{default:o(()=>[...e[26]||(e[26]=[u(" 다음 → ",-1)])]),_:1},8,["onClick"])])):y("",!0)],64)):(i(),d("div",$l,[...e[27]||(e[27]=[n("p",{class:"text-sm text-muted-foreground"},"이미지가 없습니다",-1)])]))]),n("div",wl,[n("div",Ul,[n("div",Cl,[s(l(g),null,{default:o(()=>[...e[28]||(e[28]=[u("공급업체",-1)])]),_:1}),s(l(j),{modelValue:x.value[t.materialDeliveryId].supplier,"onUpdate:modelValue":r=>x.value[t.materialDeliveryId].supplier=r},null,8,["modelValue","onUpdate:modelValue"])]),n("div",Ll,[s(l(g),null,{default:o(()=>[...e[29]||(e[29]=[u("납품일",-1)])]),_:1}),s(l(j),{modelValue:x.value[t.materialDeliveryId].deliveryDate,"onUpdate:modelValue":r=>x.value[t.materialDeliveryId].deliveryDate=r,type:"date"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",Vl,[s(l(g),null,{default:o(()=>[...e[30]||(e[30]=[u("위치",-1)])]),_:1}),s(l(j),{modelValue:x.value[t.materialDeliveryId].location,"onUpdate:modelValue":r=>x.value[t.materialDeliveryId].location=r,placeholder:"예: A동 3층"},null,8,["modelValue","onUpdate:modelValue"])])]),n("div",Sl,[s(l(Qe),null,{default:o(()=>[s(l(Ge),null,{default:o(()=>[s(l(ve),null,{default:o(()=>[s(l(L),null,{default:o(()=>[...e[31]||(e[31]=[u("제조사",-1)])]),_:1}),s(l(L),null,{default:o(()=>[...e[32]||(e[32]=[u("규격",-1)])]),_:1}),s(l(L),{class:"w-[200px] text-right"},{default:o(()=>[...e[33]||(e[33]=[u("수량",-1)])]),_:1})]),_:1})]),_:1}),s(l(He),null,{default:o(()=>[(i(!0),d(p,null,_(z.value[t.materialDeliveryId],(r,f)=>(i(),w(l(ve),{key:r.deliveryLineId??f,class:ze({"bg-yellow-50 dark:bg-yellow-950/30":!r.specValidation})},{default:o(()=>[s(l(V),null,{default:o(()=>[s(l(j),{"model-value":r.manufacturer??"",class:"h-8 text-sm","onUpdate:modelValue":v=>r.manufacturer=v||null},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),s(l(V),null,{default:o(()=>[n("div",El,[s(l(pe),{"model-value":r.materialSpecId!=null?String(r.materialSpecId):"","onUpdate:modelValue":v=>{const fe=le.value.find(Ut=>Ut.id===Number(v));r.materialSpecId=fe?fe.id:null,r.materialSpecName=fe?fe.name:null}},{default:o(()=>[s(l(ge),{class:"h-8 text-sm"},{default:o(()=>[s(l(_e),{placeholder:"규격 선택"})]),_:1}),s(l(ye),null,{default:o(()=>[(i(!0),d(p,null,_(le.value,v=>(i(),w(l(xe),{key:v.id,value:String(v.id)},{default:o(()=>[u(m(v.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"]),r.specValidation?(i(),d("span",Nl," ✅ ")):(i(),d("span",Ml," ⚠️ "))])]),_:2},1024),s(l(V),null,{default:o(()=>[n("div",Ol,[s(l(j),{"model-value":String(r.quantity),class:"h-8 text-sm text-right","onUpdate:modelValue":v=>r.quantity=Number(v)||0},null,8,["model-value","onUpdate:modelValue"]),n("span",Tl,m(t.unit),1)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:2},1024)]),_:2},1024)]),n("div",Pl,[s(l(k),{disabled:ce.value[t.materialDeliveryId],onClick:r=>kt(t)},{default:o(()=>[u(m(ce.value[t.materialDeliveryId]?"저장 중...":"수정하기"),1)]),_:2},1032,["disabled","onClick"])])])]))])):y("",!0)]))),128))]))]),"tab-outgoing":o(()=>[...e[34]||(e[34]=[n("div",{class:"flex-1 flex items-center justify-center border border-dashed border-border rounded-lg"},[n("p",{class:"text-muted-foreground"},"반출 자재 (구현 예정)")],-1)])]),"tab-remaining":o(()=>[...e[35]||(e[35]=[n("div",{class:"flex-1 flex items-center justify-center border border-dashed border-border rounded-lg"},[n("p",{class:"text-muted-foreground"},"잔여 자재 (구현 예정)")],-1)])]),_:1}),s(l(lt),{open:R.value,"onUpdate:open":e[3]||(e[3]=t=>R.value=t)},{default:o(()=>[s(l(Je),{class:"sm:max-w-[520px]"},{default:o(()=>[s(l(Ke),null,{default:o(()=>[s(l(et),null,{default:o(()=>[...e[36]||(e[36]=[u("송장입력",-1)])]),_:1})]),_:1}),n("div",Rl,[n("div",jl,[s(l(g),null,{default:o(()=>[...e[37]||(e[37]=[u("송장파일",-1)])]),_:1}),n("input",{type:"file",multiple:"",accept:".pdf,.png,.jpg,.jpeg",class:"block w-full text-sm text-foreground file:mr-3 file:py-1.5 file:px-3 file:rounded file:border file:border-input file:bg-muted file:text-sm file:font-medium hover:file:bg-muted/80 cursor-pointer",onChange:rt},null,32)]),n("div",Fl,[s(l(g),null,{default:o(()=>[...e[38]||(e[38]=[u("반입사진",-1)])]),_:1}),n("input",{type:"file",multiple:"",accept:"image/*",class:"block w-full text-sm text-foreground file:mr-3 file:py-1.5 file:px-3 file:rounded file:border file:border-input file:bg-muted file:text-sm file:font-medium hover:file:bg-muted/80 cursor-pointer",onChange:nt},null,32)]),Te.value.length>0?(i(),d("div",ql,[s(l(g),null,{default:o(()=>[...e[39]||(e[39]=[u("존",-1)])]),_:1}),n("div",zl,[(i(!0),d(p,null,_(Te.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`zone-${t.id}`,"model-value":A.value.includes(t.id),"onUpdate:modelValue":r=>A.value=N(A.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`zone-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,Al)]))),128))])])):y("",!0),Pe.value.length>0?(i(),d("div",Bl,[s(l(g),null,{default:o(()=>[...e[40]||(e[40]=[u("층",-1)])]),_:1}),n("div",Wl,[(i(!0),d(p,null,_(Pe.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`floor-${t.id}`,"model-value":B.value.includes(t.id),"onUpdate:modelValue":r=>B.value=N(B.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`floor-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,Zl)]))),128))])])):y("",!0),Re.value.length>0?(i(),d("div",Xl,[s(l(g),null,{default:o(()=>[...e[41]||(e[41]=[u("구역",-1)])]),_:1}),n("div",Yl,[(i(!0),d(p,null,_(Re.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`section-${t.id}`,"model-value":W.value.includes(t.id),"onUpdate:modelValue":r=>W.value=N(W.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`section-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,Ql)]))),128))])])):y("",!0),je.value.length>0?(i(),d("div",Gl,[s(l(g),null,{default:o(()=>[...e[42]||(e[42]=[u("용도",-1)])]),_:1}),n("div",Hl,[(i(!0),d(p,null,_(je.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`usage-${t.id}`,"model-value":Z.value.includes(t.id),"onUpdate:modelValue":r=>Z.value=N(Z.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`usage-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,Jl)]))),128))])])):y("",!0)]),s(l(tt),{class:"flex-col items-end gap-2"},{default:o(()=>[n("div",Kl,[s(l(k),{variant:"outline",onClick:e[2]||(e[2]=t=>R.value=!1)},{default:o(()=>[...e[43]||(e[43]=[u("취소",-1)])]),_:1}),s(l(k),{disabled:X.value,onClick:it},{default:o(()=>[u(m(X.value?"저장 중...":"저장"),1)]),_:1},8,["disabled"])]),X.value?(i(),d("p",ea," 시간이 좀 걸립니다. 기다려주세요. ")):y("",!0)]),_:1})]),_:1})]),_:1},8,["open"]),s(l(lt),{open:Y.value,"onUpdate:open":e[7]||(e[7]=t=>Y.value=t)},{default:o(()=>[s(l(Je),{class:"sm:max-w-[520px]"},{default:o(()=>[s(l(Ke),null,{default:o(()=>[s(l(et),null,{default:o(()=>[...e[44]||(e[44]=[u("발주서 없이 송장입력",-1)])]),_:1})]),_:1}),n("div",ta,[n("div",la,[s(l(g),null,{default:o(()=>[...e[45]||(e[45]=[u("자재유형",-1)])]),_:1}),s(l(pe),{modelValue:Q.value,"onUpdate:modelValue":e[4]||(e[4]=t=>Q.value=t)},{default:o(()=>[s(l(ge),null,{default:o(()=>[s(l(_e),{placeholder:"자재유형 선택"})]),_:1}),s(l(ye),null,{default:o(()=>[(i(!0),d(p,null,_(We.value,t=>(i(),w(l(xe),{key:t.id,value:String(t.id)},{default:o(()=>[u(m(t.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue"])]),n("div",aa,[s(l(g),null,{default:o(()=>[...e[46]||(e[46]=[u("분류 (선택사항)",-1)])]),_:1}),s(l(pe),{"model-value":F.value,"onUpdate:modelValue":dt},{default:o(()=>[s(l(ge),null,{default:o(()=>[s(l(_e),{placeholder:"분류 선택"})]),_:1}),s(l(ye),null,{default:o(()=>[(i(!0),d(p,null,_(Ze.value,t=>(i(),w(l(xe),{key:t.id,value:String(t.id)},{default:o(()=>[u(m(t.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),n("div",sa,[s(l(g),null,{default:o(()=>[...e[47]||(e[47]=[u("공종 (선택사항)",-1)])]),_:1}),s(l(pe),{modelValue:q.value,"onUpdate:modelValue":e[5]||(e[5]=t=>q.value=t),disabled:!F.value||ue.value},{default:o(()=>[s(l(ge),null,{default:o(()=>[s(l(_e),{placeholder:ue.value?"로딩중...":"공종 선택"},null,8,["placeholder"])]),_:1}),s(l(ye),null,{default:o(()=>[(i(!0),d(p,null,_(ie.value,t=>(i(),w(l(xe),{key:t.id,value:String(t.id)},{default:o(()=>[u(m(t.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["modelValue","disabled"])]),n("div",oa,[s(l(g),null,{default:o(()=>[...e[48]||(e[48]=[u("송장파일",-1)])]),_:1}),n("input",{type:"file",multiple:"",accept:".pdf,.png,.jpg,.jpeg",class:"block w-full text-sm text-foreground file:mr-3 file:py-1.5 file:px-3 file:rounded file:border file:border-input file:bg-muted file:text-sm file:font-medium hover:file:bg-muted/80 cursor-pointer",onChange:ct},null,32)]),n("div",ra,[s(l(g),null,{default:o(()=>[...e[49]||(e[49]=[u("반입사진",-1)])]),_:1}),n("input",{type:"file",multiple:"",accept:"image/*",class:"block w-full text-sm text-foreground file:mr-3 file:py-1.5 file:px-3 file:rounded file:border file:border-input file:bg-muted file:text-sm file:font-medium hover:file:bg-muted/80 cursor-pointer",onChange:mt},null,32)]),we.value.length>0?(i(),d("div",na,[s(l(g),null,{default:o(()=>[...e[50]||(e[50]=[u("존",-1)])]),_:1}),n("div",ia,[(i(!0),d(p,null,_(we.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`direct-zone-${t.id}`,"model-value":H.value.includes(t.id),"onUpdate:modelValue":r=>H.value=N(H.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`direct-zone-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,ua)]))),128))])])):y("",!0),Ue.value.length>0?(i(),d("div",da,[s(l(g),null,{default:o(()=>[...e[51]||(e[51]=[u("층",-1)])]),_:1}),n("div",ca,[(i(!0),d(p,null,_(Ue.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`direct-floor-${t.id}`,"model-value":J.value.includes(t.id),"onUpdate:modelValue":r=>J.value=N(J.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`direct-floor-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,ma)]))),128))])])):y("",!0),Ce.value.length>0?(i(),d("div",fa,[s(l(g),null,{default:o(()=>[...e[52]||(e[52]=[u("구역",-1)])]),_:1}),n("div",va,[(i(!0),d(p,null,_(Ce.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`direct-section-${t.id}`,"model-value":K.value.includes(t.id),"onUpdate:modelValue":r=>K.value=N(K.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`direct-section-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,pa)]))),128))])])):y("",!0),Le.value.length>0?(i(),d("div",ga,[s(l(g),null,{default:o(()=>[...e[53]||(e[53]=[u("용도",-1)])]),_:1}),n("div",_a,[(i(!0),d(p,null,_(Le.value,t=>(i(),d("div",{key:t.id,class:"flex items-center gap-1.5"},[s(l(M),{id:`direct-usage-${t.id}`,"model-value":ee.value.includes(t.id),"onUpdate:modelValue":r=>ee.value=N(ee.value,t.id)},null,8,["id","model-value","onUpdate:modelValue"]),n("label",{for:`direct-usage-${t.id}`,class:"text-sm cursor-pointer"},m(t.name),9,ya)]))),128))])])):y("",!0)]),s(l(tt),{class:"flex-col items-end gap-2"},{default:o(()=>[n("div",xa,[s(l(k),{variant:"outline",onClick:e[6]||(e[6]=t=>Y.value=!1)},{default:o(()=>[...e[54]||(e[54]=[u("취소",-1)])]),_:1}),s(l(k),{disabled:G.value,onClick:ft},{default:o(()=>[u(m(G.value?"저장 중...":"저장"),1)]),_:1},8,["disabled"])]),G.value?(i(),d("p",Da," 시간이 좀 걸립니다. 기다려주세요. ")):y("",!0)]),_:1})]),_:1})]),_:1},8,["open"]),s(l(zt),{open:de.value,"onUpdate:open":e[8]||(e[8]=t=>de.value=t)},{default:o(()=>[s(l(Ot),null,{default:o(()=>[s(l(Tt),null,{default:o(()=>[s(l(Pt),null,{default:o(()=>[...e[55]||(e[55]=[u("삭제 확인",-1)])]),_:1}),s(l(Rt),null,{default:o(()=>[u(" '"+m(Xe.value)+"' 반입자재를 삭제하시겠습니까? ",1)]),_:1})]),_:1}),s(l(jt),null,{default:o(()=>[s(l(Ft),{disabled:te.value},{default:o(()=>[...e[56]||(e[56]=[u("취소",-1)])]),_:1},8,["disabled"]),s(l(qt),{disabled:te.value,onClick:pt},{default:o(()=>[u(m(te.value?"삭제 중...":"삭제"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1}))}});export{za as default};
