import{_ as $e}from"./PageContainer.vue_vue_type_script_setup_true_lang-BIH9eeFm.js";import{_ as _e}from"./AreaCard.vue_vue_type_script_setup_true_lang-BUJNG2ka.js";import{_ as B}from"./index-CKTY9j9I.js";import{_ as ae}from"./Input.vue_vue_type_script_setup_true_lang-CGgGVb3D.js";import{r as ce}from"./reference-B-qmHaHf.js";import{a as le,e as xe}from"./equipment-Cq0MBPgm.js";import{r as A,D as be,d as oe,c,o as i,a as r,e as a,t as D,w as k,u as e,F as z,n as j,p as ee,g as V,j as te,y as se,i as Ie,U as Te}from"./index-DG8erdFC.js";import{a as de,b as ue,c as me,d as pe,_ as fe}from"./SelectValue.vue_vue_type_script_setup_true_lang-CYzgvYD3.js";import{X as ye}from"./x-CwbFRCqd.js";import{c as ve}from"./createLucideIcon-CDvnuoGZ.js";import"./Collection-BA_9eYIH.js";import"./index-CE7v__89.js";import"./utils-DU_xaL7B.js";import"./apiClient-r2tmWO-w.js";import"./check-DENv59y8.js";const ge=ve("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const ie=ve("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);const Z=ve("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function Se(){const n=new Date,x=n.getFullYear(),$=String(n.getMonth()+1).padStart(2,"0"),v=String(n.getDate()).padStart(2,"0");return`${x}-${$}-${v}`}function re(n){const x=n;return x.response?.data?.message||x.message||"알 수 없는 오류가 발생했습니다."}let he=0;function qe(){const n=A(Se()),x=A(!1),$=A([]),v=A(!1),E=A([]),g=A([]),t=A(new Map);async function f(){try{E.value=await le.getContractorList(n.value)}catch(d){console.error("업체 목록 로드 실패:",d),alert(re(d))}}async function s(){try{v.value=!0,$.value=await le.getAttendanceListByDate(n.value)}catch(d){console.error("출역인원 조회 실패:",d),$.value=[]}finally{v.value=!1}await y()}async function y(){if(g.value=[],t.value.clear(),$.value.length===0)return;const d=new Map;for(const m of $.value)d.has(m.companyId)||d.set(m.companyId,[]),d.get(m.companyId).push(m);const b=[];for(const[m,w]of d){const L=w[0];if(!L)continue;const I=`box-${++he}`;g.value.push({id:I,companyId:m,companyName:L.companyDisplayName,workTypeId:L.workTypeId,workTypeName:L.workTypeName,laborTypes:[],isLoading:!0});const Y=ce.getLaborTypeListByWorkType(L.workTypeId).then(F=>{const H=g.value.find(R=>R.id===I);if(H){H.laborTypes=F;for(const R of F){const O=w.find(o=>o.laborTypeId===R.id);t.value.set(`${I}-${R.id}`,O?O.count:0)}}}).catch(F=>{console.error(`직종 목록 로드 실패 (${L.companyDisplayName}):`,F)}).finally(()=>{const F=g.value.find(H=>H.id===I);F&&(F.isLoading=!1)});b.push(Y)}await Promise.all(b),t.value=new Map(t.value)}be(n,()=>{f(),s()});function _(){const d={id:`box-${++he}`,companyId:null,companyName:"",workTypeId:null,workTypeName:"",laborTypes:[],isLoading:!1};g.value.push(d)}async function p(d,b){const m=g.value.find(I=>I.id===d);if(!m)return;const w=E.value.find(I=>I.companyId===b);if(!w)return;if(g.value.some(I=>I.id!==d&&I.companyId===b)){alert("이미 추가된 업체입니다.");return}if(!w.workTypeId){alert("해당 업체에 등록된 공종이 없습니다.");return}m.laborTypes.length>0&&m.laborTypes.forEach(I=>{t.value.delete(`${d}-${I.id}`)}),m.companyId=w.companyId,m.companyName=w.companyDisplayName,m.workTypeId=w.workTypeId,m.workTypeName=w.workTypeName||"",m.isLoading=!0;try{const I=await ce.getLaborTypeListByWorkType(w.workTypeId);m.laborTypes=I,I.forEach(Y=>{t.value.set(`${d}-${Y.id}`,0)})}catch(I){console.error("직종 목록 로드 실패:",I),alert(re(I)),m.companyId=null,m.companyName="",m.workTypeId=null,m.workTypeName=""}finally{m.isLoading=!1}}function N(d){const b=g.value.find(m=>m.id===d);b&&b.laborTypes.forEach(m=>{t.value.delete(`${d}-${m.id}`)}),g.value=g.value.filter(m=>m.id!==d)}function X(d,b){return`${d}-${b}`}function U(d,b){return t.value.get(X(d,b))||0}function P(d,b,m){t.value.set(X(d,b),Math.max(0,m))}function J(d,b){const m=U(d,b);P(d,b,m+1)}function G(d,b){const m=U(d,b);P(d,b,m-1)}async function K(){const d=g.value.filter(w=>w.companyId&&w.workTypeId);if(d.length===0){alert("제출할 출역인원이 없습니다.");return}const b=new Map;for(const w of d)if(w.companyId)for(const L of w.laborTypes){const I=U(w.id,L.id);I>0&&(b.has(w.companyId)||b.set(w.companyId,[]),b.get(w.companyId).push({laborTypeId:L.id,count:I}))}if(b.size===0){alert("입력된 인원이 없습니다.");return}const m=[];b.forEach((w,L)=>{m.push({companyId:L,attendances:w})});try{x.value=!0,await le.updateAttendance({date:n.value,entries:m}),alert("출역인원이 저장되었습니다."),await s()}catch(w){console.error("출역인원 저장 실패:",w),alert(re(w))}finally{x.value=!1}}async function ne(){await Promise.all([f(),s()])}return{selectedDate:n,isSubmitting:x,todayAttendance:$,isLoadingToday:v,contractors:E,workTypeBoxes:g,laborCounts:t,loadContractors:f,loadTodayAttendance:s,addEmptyBox:_,selectCompany:p,removeWorkTypeBox:N,getCount:U,setCount:P,incrementCount:J,decrementCount:G,submitAttendance:K,init:ne}}function Ne(n){const x=n;return x.response?.data?.message||x.message||"알 수 없는 오류가 발생했습니다."}let ke=0;function De(n,x){const $=A(!1),v=A([]),E=A([]),g=A(!1),t=A([]),f=A(new Map),s=A(new Map);function y(o,l){return`${o}-${l}`}function _(o){return Math.round(o*2)/2}function p(o,l){return f.value.get(y(o,l))??0}function N(o,l,u){const C=y(o,l),T=new Map(f.value);T.set(C,_(Math.max(0,u))),f.value=T}function X(o,l){N(o,l,p(o,l)+.5)}function U(o,l){N(o,l,p(o,l)-.5)}function P(o,l){N(o,l,8)}function J(o,l){N(o,l,4)}function G(o,l){return s.value.get(y(o,l))??0}function K(o,l,u){const C=y(o,l),T=new Map(s.value);T.set(C,Math.max(0,Math.round(u))),s.value=T}function ne(o,l){K(o,l,G(o,l)+1)}function d(o,l){K(o,l,G(o,l)-1)}function b(o,l){const u=t.value.find(q=>q.id===o);if(!u||u.selectedSpecs.some(q=>q.id===l))return;const C=v.value.find(q=>q.id===l);if(!C)return;u.selectedSpecs.push(C);const T=y(o,l),W=new Map(f.value),M=new Map(s.value);W.set(T,0),M.set(T,1),f.value=W,s.value=M}function m(o,l){const u=t.value.find(M=>M.id===o);if(!u)return;u.selectedSpecs=u.selectedSpecs.filter(M=>M.id!==l);const C=y(o,l),T=new Map(f.value),W=new Map(s.value);T.delete(C),W.delete(C),f.value=T,s.value=W}async function w(){try{v.value=await ce.getEquipmentSpecList()}catch(o){console.error("장비규격 전체 목록 로드 실패:",o)}}async function L(){try{g.value=!0,E.value=await xe.getEquipmentDeploymentListByDate(n.value)}catch(o){console.error("출역장비 조회 실패:",o),E.value=[]}finally{g.value=!1}I()}function I(){if(t.value=[],E.value.length===0){f.value=new Map,s.value=new Map;return}const o=new Map,l=new Map,u=new Map;for(const C of E.value)u.has(C.companyId)||u.set(C.companyId,[]),u.get(C.companyId).push(C);for(const[C,T]of u){const W=T[0];if(!W)continue;const M=`ebox-${++ke}`,q=[];for(const Q of T){const h=v.value.find(S=>S.id===Q.equipmentSpecId);h&&(q.push(h),o.set(y(M,h.id),Q.workTime),l.set(y(M,h.id),Q.count))}t.value.push({id:M,companyId:C,companyName:W.companyDisplayName,selectedSpecs:q,isLoading:!1})}f.value=o,s.value=l}function Y(){t.value.push({id:`ebox-${++ke}`,companyId:null,companyName:"",selectedSpecs:[],isLoading:!1})}function F(o,l){const u=t.value.find(q=>q.id===o);if(!u)return;const C=x.value.find(q=>q.companyId===l);if(!C)return;if(t.value.some(q=>q.id!==o&&q.companyId===l)){alert("이미 추가된 업체입니다.");return}const W=new Map(f.value),M=new Map(s.value);for(const q of u.selectedSpecs)W.delete(y(o,q.id)),M.delete(y(o,q.id));f.value=W,s.value=M,u.companyId=C.companyId,u.companyName=C.companyDisplayName,u.selectedSpecs=[]}function H(o){const l=t.value.find(u=>u.id===o);if(l){const u=new Map(f.value),C=new Map(s.value);for(const T of l.selectedSpecs)u.delete(y(o,T.id)),C.delete(y(o,T.id));f.value=u,s.value=C}t.value=t.value.filter(u=>u.id!==o)}async function R(){const o=t.value.filter(u=>u.companyId);if(o.length===0){alert("제출할 출역장비가 없습니다.");return}const l=[];for(const u of o)if(u.companyId)for(const C of u.selectedSpecs){const T=y(u.id,C.id),W=s.value.get(T)??0,M=f.value.get(T)??0;W>0&&M>0&&l.push({equipmentSpecId:C.id,count:W,workTime:M,companyId:u.companyId})}if(l.length===0){alert("입력된 장비가 없습니다. 대수와 시간을 모두 입력해주세요.");return}try{$.value=!0,await xe.createEquipmentDeployment({date:n.value,entries:l}),alert("출역장비가 저장되었습니다."),await L()}catch(u){console.error("출역장비 저장 실패:",u),alert(Ne(u))}finally{$.value=!1}}be(n,()=>{L()});async function O(){await w(),await L()}return{isSubmittingEquipment:$,allEquipmentSpecs:v,todayEquipment:E,isLoadingEquipment:g,equipmentBoxes:t,equipmentWorkTimes:f,equipmentCounts:s,init:O,addEmptyBox:Y,selectCompany:F,removeEquipmentBox:H,addSpecToBox:b,removeSpecFromBox:m,getWorkTime:p,setWorkTime:N,incrementWorkTime:X,decrementWorkTime:U,setFullDay:P,setHalfDay:J,getCount:G,setCount:K,incrementCount:ne,decrementCount:d,submitEquipmentDeployment:R}}const Ee={class:"border border-border rounded-lg bg-card"},Le={class:"flex items-center justify-between px-4 py-3 border-b border-border bg-muted/50"},Me={key:0,class:"font-medium text-sm"},Be={key:1,class:"flex-1 mr-4"},We={key:0,class:"text-muted-foreground ml-2"},Ae={class:"p-4 space-y-3"},ze={key:0,class:"flex items-center justify-center py-4"},Fe={key:1,class:"text-center text-muted-foreground text-sm py-2"},je={class:"text-sm text-muted-foreground"},Ve={class:"flex items-center gap-2"},Ue={key:0,class:"text-center text-muted-foreground text-sm py-2"},He=oe({__name:"LaborCountBox",props:{boxId:{},companyId:{},companyName:{},workTypeName:{},laborTypes:{},isLoading:{type:Boolean},contractors:{},getCount:{type:Function}},emits:["remove","selectCompany","increment","decrement","setCount"],setup(n,{emit:x}){const $=n,v=x;function E(t){t&&v("selectCompany",$.boxId,String(t))}function g(t,f){const s=parseInt(String(f),10);v("setCount",$.boxId,t,isNaN(s)?0:s)}return(t,f)=>(i(),c("div",Ee,[r("div",Le,[n.companyId?(i(),c("div",Me,D(n.companyName)+" - "+D(n.workTypeName),1)):(i(),c("div",Be,[a(e(fe),{"onUpdate:modelValue":E},{default:k(()=>[a(e(de),null,{default:k(()=>[a(e(ue),{placeholder:"협력업체 선택"})]),_:1}),a(e(me),null,{default:k(()=>[(i(!0),c(z,null,j(n.contractors,s=>(i(),ee(e(pe),{key:s.companyId,value:s.companyId},{default:k(()=>[V(D(s.companyDisplayName)+" ",1),s.workTypeName?(i(),c("span",We," ("+D(s.workTypeName)+") ",1)):te("",!0)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])),a(e(B),{variant:"ghost",size:"icon-sm",onClick:f[0]||(f[0]=s=>v("remove",n.boxId))},{default:k(()=>[a(e(ye),{class:"w-4 h-4"})]),_:1})]),r("div",Ae,[n.isLoading?(i(),c("div",ze,[a(e(ge),{class:"w-5 h-5 animate-spin text-muted-foreground"}),f[1]||(f[1]=r("span",{class:"ml-2 text-sm text-muted-foreground"},"직종 목록 로딩중...",-1))])):n.companyId?(i(),c(z,{key:2},[(i(!0),c(z,null,j(n.laborTypes,s=>(i(),c("div",{key:s.id,class:"flex items-center justify-between"},[r("span",je,D(s.name),1),r("div",Ve,[a(e(B),{variant:"outline",size:"icon-sm",onClick:y=>v("decrement",n.boxId,s.id)},{default:k(()=>[a(e(ie),{class:"w-4 h-4"})]),_:1},8,["onClick"]),a(e(ae),{type:"number",class:"w-16 text-center h-8","model-value":n.getCount(n.boxId,s.id),min:"0","onUpdate:modelValue":y=>g(s.id,y)},null,8,["model-value","onUpdate:modelValue"]),a(e(B),{variant:"outline",size:"icon-sm",onClick:y=>v("increment",n.boxId,s.id)},{default:k(()=>[a(e(Z),{class:"w-4 h-4"})]),_:1},8,["onClick"])])]))),128)),n.laborTypes.length===0?(i(),c("div",Ue," 등록된 직종이 없습니다. ")):te("",!0)],64)):(i(),c("div",Fe," 협력업체를 선택해주세요. "))])]))}}),Re={class:"border border-border rounded-lg bg-card"},Pe={class:"flex items-center justify-between px-4 py-3 border-b border-border bg-muted/50"},Ge={key:0,class:"font-medium text-sm"},Ke={key:1,class:"flex-1 mr-4"},Ye={class:"p-4 space-y-3"},Xe={key:0,class:"flex items-center justify-center py-4"},Je={key:1,class:"text-center text-muted-foreground text-sm py-2"},Oe={class:"flex items-center justify-between"},Qe={class:"text-sm text-muted-foreground"},Ze={class:"flex flex-col gap-1 pl-2"},et={class:"flex items-center gap-1"},tt={class:"flex items-center gap-1 ml-2"},nt={class:"flex items-center gap-1"},ot={key:0},st={key:1,class:"text-center text-muted-foreground text-sm py-2"},at=oe({__name:"EquipmentCountBox",props:{boxId:{},companyId:{},companyName:{},selectedSpecs:{},allEquipmentSpecs:{},isLoading:{type:Boolean},contractors:{},getCount:{type:Function},getWorkTime:{type:Function}},emits:["remove","selectCompany","addSpec","removeSpec","incrementCount","decrementCount","setCount","incrementWorkTime","decrementWorkTime","setWorkTime","setFullDay","setHalfDay"],setup(n,{emit:x}){const $=n,v=x,E=se(()=>{const y=new Set($.selectedSpecs.map(_=>_.id));return $.allEquipmentSpecs.filter(_=>!y.has(_.id))});function g(y){y&&v("selectCompany",$.boxId,String(y))}function t(y){y&&v("addSpec",$.boxId,Number(y))}function f(y,_){const p=parseInt(String(_),10);v("setCount",$.boxId,y,isNaN(p)?0:p)}function s(y,_){const p=parseFloat(String(_));v("setWorkTime",$.boxId,y,isNaN(p)?0:p)}return(y,_)=>(i(),c("div",Re,[r("div",Pe,[n.companyId?(i(),c("div",Ge,D(n.companyName),1)):(i(),c("div",Ke,[a(e(fe),{"onUpdate:modelValue":g},{default:k(()=>[a(e(de),null,{default:k(()=>[a(e(ue),{placeholder:"협력업체 선택"})]),_:1}),a(e(me),null,{default:k(()=>[(i(!0),c(z,null,j(n.contractors,p=>(i(),ee(e(pe),{key:p.companyId,value:p.companyId},{default:k(()=>[V(D(p.companyDisplayName),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])),a(e(B),{variant:"ghost",size:"icon-sm",onClick:_[0]||(_[0]=p=>v("remove",n.boxId))},{default:k(()=>[a(e(ye),{class:"w-4 h-4"})]),_:1})]),r("div",Ye,[n.isLoading?(i(),c("div",Xe,[a(e(ge),{class:"w-5 h-5 animate-spin text-muted-foreground"}),_[1]||(_[1]=r("span",{class:"ml-2 text-sm text-muted-foreground"},"장비 목록 로딩중...",-1))])):n.companyId?(i(),c(z,{key:2},[(i(!0),c(z,null,j(n.selectedSpecs,p=>(i(),c("div",{key:p.id,class:"space-y-1"},[r("div",Oe,[r("span",Qe,D(p.equipmentTypeName)+" - "+D(p.name),1),a(e(B),{variant:"ghost",size:"icon-sm",class:"h-5 w-5",onClick:N=>v("removeSpec",n.boxId,p.id)},{default:k(()=>[a(e(ye),{class:"w-3 h-3"})]),_:1},8,["onClick"])]),r("div",Ze,[r("div",et,[a(e(B),{variant:"outline",size:"icon-sm",onClick:N=>v("decrementWorkTime",n.boxId,p.id)},{default:k(()=>[a(e(ie),{class:"w-3 h-3"})]),_:1},8,["onClick"]),a(e(ae),{type:"number",class:"w-16 text-center h-7 text-sm","model-value":n.getWorkTime(n.boxId,p.id),min:"0",step:"0.5","onUpdate:modelValue":N=>s(p.id,N)},null,8,["model-value","onUpdate:modelValue"]),a(e(B),{variant:"outline",size:"icon-sm",onClick:N=>v("incrementWorkTime",n.boxId,p.id)},{default:k(()=>[a(e(Z),{class:"w-3 h-3"})]),_:1},8,["onClick"]),_[4]||(_[4]=r("span",{class:"text-xs text-muted-foreground"},"시간",-1)),r("div",tt,[a(e(B),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:N=>v("setFullDay",n.boxId,p.id)},{default:k(()=>[..._[2]||(_[2]=[V(" 전일 ",-1)])]),_:1},8,["onClick"]),a(e(B),{variant:"outline",size:"sm",class:"h-7 px-2 text-xs",onClick:N=>v("setHalfDay",n.boxId,p.id)},{default:k(()=>[..._[3]||(_[3]=[V(" 반일 ",-1)])]),_:1},8,["onClick"])])]),r("div",nt,[a(e(B),{variant:"outline",size:"icon-sm",onClick:N=>v("decrementCount",n.boxId,p.id)},{default:k(()=>[a(e(ie),{class:"w-3 h-3"})]),_:1},8,["onClick"]),a(e(ae),{type:"number",class:"w-16 text-center h-7 text-sm","model-value":n.getCount(n.boxId,p.id),min:"0","onUpdate:modelValue":N=>f(p.id,N)},null,8,["model-value","onUpdate:modelValue"]),a(e(B),{variant:"outline",size:"icon-sm",onClick:N=>v("incrementCount",n.boxId,p.id)},{default:k(()=>[a(e(Z),{class:"w-3 h-3"})]),_:1},8,["onClick"]),_[5]||(_[5]=r("span",{class:"text-xs text-muted-foreground"},"대",-1))])])]))),128)),E.value.length>0?(i(),c("div",ot,[a(e(fe),{"onUpdate:modelValue":t},{default:k(()=>[a(e(de),{class:"h-8"},{default:k(()=>[a(e(ue),{placeholder:"+ 장비 추가"})]),_:1}),a(e(me),null,{default:k(()=>[(i(!0),c(z,null,j(E.value,p=>(i(),ee(e(pe),{key:p.id,value:String(p.id)},{default:k(()=>[V(D(p.equipmentTypeName)+" - "+D(p.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])):te("",!0),n.selectedSpecs.length===0&&E.value.length===0?(i(),c("div",st," 등록된 장비규격이 없습니다. ")):te("",!0)],64)):(i(),c("div",Je," 협력업체를 선택해주세요. "))])]))}}),it={class:"h-full flex flex-col"},lt={key:0,class:"flex-1 flex items-center justify-center"},rt={key:1,class:"flex-1 flex items-center justify-center"},ct={key:2,class:"flex-1 overflow-y-auto space-y-3"},dt={class:"px-4 py-2 border-b border-border bg-muted/50"},ut={class:"font-medium text-sm"},mt={class:"p-4 space-y-3"},pt={key:0},ft={class:"space-y-1"},yt={class:"text-muted-foreground"},vt={class:"font-medium"},gt={key:1},xt={class:"space-y-1"},ht={class:"text-muted-foreground"},kt={class:"font-medium"},bt=oe({__name:"TodayAttendanceBox",props:{attendances:{},isLoading:{type:Boolean},equipmentDeployments:{default:()=>[]},isLoadingEquipment:{type:Boolean,default:!1}},setup(n){const x=n,$=se(()=>{const g=new Map;for(const t of x.attendances)g.has(t.companyId)||g.set(t.companyId,{companyId:t.companyId,companyDisplayName:t.companyDisplayName,laborItems:[],equipmentItems:[]}),g.get(t.companyId).laborItems.push(t);for(const t of x.equipmentDeployments)g.has(t.companyId)||g.set(t.companyId,{companyId:t.companyId,companyDisplayName:t.companyDisplayName,laborItems:[],equipmentItems:[]}),g.get(t.companyId).equipmentItems.push(t);return Array.from(g.values())}),v=se(()=>x.attendances.length===0&&x.equipmentDeployments.length===0),E=se(()=>x.isLoading||x.isLoadingEquipment);return(g,t)=>(i(),c("div",it,[E.value?(i(),c("div",lt,[a(e(ge),{class:"w-5 h-5 animate-spin text-muted-foreground"}),t[0]||(t[0]=r("span",{class:"ml-2 text-sm text-muted-foreground"},"로딩중...",-1))])):v.value?(i(),c("div",rt,[...t[1]||(t[1]=[r("p",{class:"text-sm text-muted-foreground"},"등록된 출역 정보가 없습니다.",-1)])])):(i(),c("div",ct,[(i(!0),c(z,null,j($.value,f=>(i(),c("div",{key:f.companyId,class:"border border-border rounded-lg bg-card"},[r("div",dt,[r("span",ut,D(f.companyDisplayName),1)]),r("div",mt,[f.laborItems.length>0?(i(),c("div",pt,[t[2]||(t[2]=r("p",{class:"text-xs text-muted-foreground font-medium mb-1"},"오늘 출역 인원",-1)),r("div",ft,[(i(!0),c(z,null,j(f.laborItems,s=>(i(),c("div",{key:`labor-${s.companyId}-${s.laborTypeId}`,class:"flex items-center justify-between text-sm pl-2"},[r("span",yt,D(s.laborTypeName),1),r("span",vt,D(s.count)+"명",1)]))),128))])])):te("",!0),f.equipmentItems.length>0?(i(),c("div",gt,[t[3]||(t[3]=r("p",{class:"text-xs text-muted-foreground font-medium mb-1"},"오늘 출역 장비",-1)),r("div",xt,[(i(!0),c(z,null,j(f.equipmentItems,s=>(i(),c("div",{key:`equip-${s.companyId}-${s.equipmentSpecId}`,class:"flex items-center justify-between text-sm pl-2"},[r("span",ht,D(s.equipmentTypeName)+" "+D(s.equipmentSpecName),1),r("span",kt,D(s.count)+"대 "+D(s.workTime)+"시간",1)]))),128))])])):te("",!0)])]))),128))]))]))}}),wt={class:"flex flex-col h-full"},Ct={class:"flex items-center justify-center gap-2 py-4 border-b border-border"},$t={class:"flex-1 overflow-hidden grid grid-cols-3 gap-4 p-4"},_t={class:"flex flex-col overflow-hidden border border-border rounded-lg bg-card"},It={class:"flex-1 overflow-y-auto p-4"},Tt={class:"flex flex-col overflow-hidden border border-border rounded-lg bg-card"},St={class:"flex-1 overflow-y-auto p-4"},qt={key:0,class:"flex items-center justify-center h-full"},Nt={key:1,class:"space-y-4"},Dt={class:"flex items-center justify-between px-4 py-3 border-t border-border"},Et={class:"flex flex-col overflow-hidden border border-border rounded-lg bg-card"},Lt={class:"flex-1 overflow-y-auto p-4"},Mt={key:0,class:"flex items-center justify-center h-full"},Bt={key:1,class:"space-y-4"},Wt={class:"flex items-center justify-between px-4 py-3 border-t border-border"},At=oe({__name:"AttendanceTab",setup(n){const{selectedDate:x,isSubmitting:$,todayAttendance:v,isLoadingToday:E,contractors:g,workTypeBoxes:t,addEmptyBox:f,selectCompany:s,removeWorkTypeBox:y,getCount:_,incrementCount:p,decrementCount:N,setCount:X,submitAttendance:U,init:P}=qe(),{isSubmittingEquipment:J,allEquipmentSpecs:G,todayEquipment:K,isLoadingEquipment:ne,equipmentBoxes:d,addEmptyBox:b,selectCompany:m,removeEquipmentBox:w,addSpecToBox:L,removeSpecFromBox:I,getCount:Y,incrementCount:F,decrementCount:H,setCount:R,getWorkTime:O,incrementWorkTime:o,decrementWorkTime:l,setWorkTime:u,setFullDay:C,setHalfDay:T,submitEquipmentDeployment:W,init:M}=De(x,g);function q(Q){const h=new Date(x.value);h.setDate(h.getDate()+Q);const S=h.getFullYear(),we=String(h.getMonth()+1).padStart(2,"0"),Ce=String(h.getDate()).padStart(2,"0");x.value=`${S}-${we}-${Ce}`}return Ie(async()=>{await P(),await M()}),(Q,h)=>(i(),c("div",wt,[r("div",Ct,[a(e(B),{variant:"outline",size:"icon-sm",onClick:h[0]||(h[0]=S=>q(-1))},{default:k(()=>[a(e(ie),{class:"w-4 h-4"})]),_:1}),a(e(ae),{modelValue:e(x),"onUpdate:modelValue":h[1]||(h[1]=S=>Te(x)?x.value=S:null),type:"date",class:"w-48"},null,8,["modelValue"]),a(e(B),{variant:"outline",size:"icon-sm",onClick:h[2]||(h[2]=S=>q(1))},{default:k(()=>[a(e(Z),{class:"w-4 h-4"})]),_:1})]),r("div",$t,[r("div",_t,[h[3]||(h[3]=r("div",{class:"px-4 py-3 border-b border-border bg-muted/50"},[r("h3",{class:"text-sm font-medium"},"오늘 출역")],-1)),r("div",It,[a(bt,{attendances:e(v),"is-loading":e(E),"equipment-deployments":e(K),"is-loading-equipment":e(ne)},null,8,["attendances","is-loading","equipment-deployments","is-loading-equipment"])])]),r("div",Tt,[h[6]||(h[6]=r("div",{class:"px-4 py-3 border-b border-border bg-muted/50"},[r("h3",{class:"text-sm font-medium"},"출역인원 입력")],-1)),r("div",St,[e(t).length===0?(i(),c("div",qt,[...h[4]||(h[4]=[r("p",{class:"text-muted-foreground text-sm"},"추가 버튼을 눌러 업체를 추가하세요.",-1)])])):(i(),c("div",Nt,[(i(!0),c(z,null,j(e(t),S=>(i(),ee(He,{key:S.id,"box-id":S.id,"company-id":S.companyId,"company-name":S.companyName,"work-type-name":S.workTypeName,"labor-types":S.laborTypes,"is-loading":S.isLoading,contractors:e(g),"get-count":e(_),onRemove:e(y),onSelectCompany:e(s),onIncrement:e(p),onDecrement:e(N),onSetCount:e(X)},null,8,["box-id","company-id","company-name","work-type-name","labor-types","is-loading","contractors","get-count","onRemove","onSelectCompany","onIncrement","onDecrement","onSetCount"]))),128))]))]),r("div",Dt,[a(e(B),{size:"sm",onClick:e(f)},{default:k(()=>[a(e(Z),{class:"w-4 h-4 mr-2"}),h[5]||(h[5]=V(" 추가 ",-1))]),_:1},8,["onClick"]),a(e(B),{size:"lg",disabled:e(t).length===0||e($),onClick:e(U)},{default:k(()=>[V(D(e($)?"저장 중...":"제출"),1)]),_:1},8,["disabled","onClick"])])]),r("div",Et,[h[9]||(h[9]=r("div",{class:"px-4 py-3 border-b border-border bg-muted/50"},[r("h3",{class:"text-sm font-medium"},"출역장비 입력")],-1)),r("div",Lt,[e(d).length===0?(i(),c("div",Mt,[...h[7]||(h[7]=[r("p",{class:"text-muted-foreground text-sm"},"추가 버튼을 눌러 업체를 추가하세요.",-1)])])):(i(),c("div",Bt,[(i(!0),c(z,null,j(e(d),S=>(i(),ee(at,{key:S.id,"box-id":S.id,"company-id":S.companyId,"company-name":S.companyName,"selected-specs":S.selectedSpecs,"all-equipment-specs":e(G),"is-loading":S.isLoading,contractors:e(g),"get-count":e(Y),"get-work-time":e(O),onRemove:e(w),onSelectCompany:e(m),onAddSpec:e(L),onRemoveSpec:e(I),onIncrementCount:e(F),onDecrementCount:e(H),onSetCount:e(R),onIncrementWorkTime:e(o),onDecrementWorkTime:e(l),onSetWorkTime:e(u),onSetFullDay:e(C),onSetHalfDay:e(T)},null,8,["box-id","company-id","company-name","selected-specs","all-equipment-specs","is-loading","contractors","get-count","get-work-time","onRemove","onSelectCompany","onAddSpec","onRemoveSpec","onIncrementCount","onDecrementCount","onSetCount","onIncrementWorkTime","onDecrementWorkTime","onSetWorkTime","onSetFullDay","onSetHalfDay"]))),128))]))]),r("div",Wt,[a(e(B),{size:"sm",onClick:e(b)},{default:k(()=>[a(e(Z),{class:"w-4 h-4 mr-2"}),h[8]||(h[8]=V(" 추가 ",-1))]),_:1},8,["onClick"]),a(e(B),{size:"lg",disabled:e(d).length===0||e(J),onClick:e(W)},{default:k(()=>[V(D(e(J)?"저장 중...":"제출"),1)]),_:1},8,["disabled","onClick"])])])])]))}}),Zt=oe({__name:"AttendanceInputPage",setup(n){return(x,$)=>(i(),ee($e,{title:"출역입력"},{default:k(()=>[a(_e,{height:"flex-1"},{default:k(()=>[a(At)]),_:1})]),_:1}))}});export{Zt as default};
